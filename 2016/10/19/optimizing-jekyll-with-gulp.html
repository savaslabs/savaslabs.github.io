<!DOCTYPE html>
<html lang="en-US">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="cache-control" content="public">
  <meta http-equiv="expires" content="86400">
  
  <title>Optimizing Jekyll Performance with Gulp | Savas Labs</title>
  
  <meta name="description" content="It’s hard to believe it’s been over a year and a half since our site’s inaugural blog post (written just two months after my career change into web developme...">
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="canonical" href="https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html">
  <link rel="alternate" type="application/rss+xml" title="Savas Labs" href="https://savaslabs.com/feed.xml" />

  <!-- Structured data. -->
  
  
  
  




  
  
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "about": "How we improved our company site's performance with a better Jekyll workflow
",
      "articleBody": "&lt;p&gt;It’s hard to believe it’s been over a year and a half since our site’s &lt;a href=&quot;https://savaslabs.com/2015/04/01/building-our-site.html&quot;&gt;inaugural blog post&lt;/a&gt; (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll&lt;/code&gt; commands to build the site. Instead, we’re using &lt;a href=&quot;http://gulpjs.com/&quot;&gt;gulp&lt;/a&gt;, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!&lt;/p&gt;

&lt;p&gt;We based a lot of our gulp workflow on
&lt;a href=&quot;https://robwise.github.io/blog/jekyll-and-gulp&quot;&gt;this excellent post&lt;/a&gt; by Rob Wise.
Our workflow includes a few additional features like:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Separate gulp tasks for building the site locally,
for testing purposes, and for production&lt;/li&gt;
  &lt;li&gt;Some updated gulp plugins&lt;/li&gt;
  &lt;li&gt;Inlining of critical CSS&lt;/li&gt;
  &lt;li&gt;Some further improvements to responsive images&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;…but I’d definitely recommend his post and you’ll see some of his code and
architecture throughout this article.&lt;/p&gt;

&lt;p&gt;To see all of our current code, pop over to our
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io&quot;&gt;GitHub repo&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;We know how important site performance is to
&lt;a href=&quot;http://alistapart.com/article/improving-ux-through-front-end-performance&quot;&gt;user experience&lt;/a&gt;.
We’ve been showing this to our clients for years, and we finally found the time
to be able to practice what we preach!&lt;/p&gt;

&lt;p&gt;Our ultimate motivator was our not-so-great Google PageSpeed score.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://savaslabs.com/assets/img/blog/pagespeed-insights-initial.jpg&quot; alt=&quot;Initial Google PageSpeed Insights score for savaslabs.com. Several significant problems exist!&quot; class=&quot;blog-image-full-width&quot; /&gt;
&lt;span class=&quot;caption&quot;&gt;Yikes!&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Going off of these recommendations and adding a few things of our own, we ended
up with a nice to-do list:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Optimize CSS:
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Minification_(programming)&quot;&gt;Minify&lt;/a&gt; our main
CSS file to remove unnecessary characters and shrink the filesize.&lt;/li&gt;
      &lt;li&gt;Use autoprefixer to add
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Vendor_Prefix&quot;&gt;vendor prefixes&lt;/a&gt;
(since this will be required for the soon-to-come Bourbon v5.0).&lt;/li&gt;
      &lt;li&gt;To prevent our large CSS file from delaying the initial render for the end
user, insert CSS that’s critical to above-the-fold content into the HTML
head. By “above the fold” I mean content viewable to the user on the initial
page load before interacting with the site.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Optimize JS:
    &lt;ul&gt;
      &lt;li&gt;Concatenate and &lt;a href=&quot;https://github.com/mishoo/UglifyJS&quot;&gt;uglify&lt;/a&gt; our JS files
to create a single, minified file, smaller than the larger files we started with.&lt;/li&gt;
      &lt;li&gt;Execute our JS asynchronously, meaning it will be executed when it’s ready
while the page is loading without interfering with the render.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Optimize images:
    &lt;ul&gt;
      &lt;li&gt;Manually shrink our image file sizes, then set up gulp to
&lt;a href=&quot;https://github.com/imagemin/imagemin&quot;&gt;optimize&lt;/a&gt; them even further for the
smallest images possible.&lt;/li&gt;
      &lt;li&gt;Use the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element over simple &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;img&amp;gt;&lt;/code&gt; tags. The &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt;
 element contains an array of different sizes of the same image and allows
 the browser to pick the smallest one that will look good on the user’s
 screen size and resolution, so only the smallest possible image is loaded.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;One thing reported by PageSpeed not yet on our to-do list is “leverage
browser caching” — we’re not going to tackle this just yet since we’re using
GitHub Pages to host our site and we don’t have control over caching headers. On
a side note, if you have a solution to this problem, please leave us a comment!&lt;/p&gt;

&lt;p&gt;From here I’ll go over how we set up gulp to work with our Jekyll site, then how
we used gulp to accomplish the tasks above.&lt;/p&gt;

&lt;h2 id=&quot;initial-setup&quot;&gt;Initial setup&lt;/h2&gt;

&lt;h3 id=&quot;changes-to-jekyll-directory-structure&quot;&gt;Changes to Jekyll directory structure&lt;/h3&gt;

&lt;p&gt;Our fonts, images, scripts, and SCSS files were previously stored in a directory
called &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt;. The &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; command would copy this directory into the
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; folder so the assets within could be included in HTML files and used to
theme the site.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~/Sites/savaslabs.com/assets &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tree &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; 1
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
├── fonts
├── img
├── js
└── styles
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since we’re going to be processing our assets with gulp instead, we moved the
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory to &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; to indicate that it should be ignored by Jekyll.&lt;/p&gt;

&lt;p&gt;Our basic workflow is to use gulp to process the contents of &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt;,
outputting them into a git-ignored directory &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; which will be copied by
Jekyll into the generated &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory. In addition, for local development
we created a &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; task using &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp.watch()&lt;/code&gt; to process assets as
they’re updated and copy them directly into the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory, then push the
changes to the browser via BrowserSync.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://savaslabs.com/assets/img/blog/gulp-workflow.svg&quot; alt=&quot;Diagram of our basic gulp workflow&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;changes-to-jekyll-config&quot;&gt;Changes to Jekyll config&lt;/h3&gt;

&lt;p&gt;We also needed to make some updates to our Jekyll config:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Delete this since Jekyll is no longer processing sass.&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;sass_dir&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;assets/styles&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Exclude the following from the Jekyll build process.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Note: &quot;vendor&quot; is for Travis CI.&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;exclude&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;vendor&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;_assets&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Gemfile&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Gemfile.lock&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;gulpfile.js&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;node_modules&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;package.json&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I’d also like to note that we’re using a few different config files: our default
&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.test.yml&lt;/code&gt; which uses blank URL and base URL variables so
tests can be run locally, and &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.dev.yml&lt;/code&gt; which sets variables for our
local &lt;a href=&quot;https://github.com/savaslabs/squabble&quot;&gt;comment server&lt;/a&gt; for development
purposes. These different config files will come into play as we set up the
gulpfile.&lt;/p&gt;

&lt;p&gt;Finally, we updated our &lt;code class=&quot;highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; to include the following:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# .gitignore
node_modules
assets
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;node_modules&lt;/code&gt; will hold all of our node.js dependencies, and &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; is the
directory that will be generated by gulp and copied by Jekyll into the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory. The &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory (no underscore) will hold processed asset
files and we’ll only be keeping the unprocessed files (the &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; directory)
in version control.&lt;/p&gt;

&lt;h3 id=&quot;paths-file&quot;&gt;Paths file&lt;/h3&gt;

&lt;p&gt;This comes straight from &lt;a href=&quot;https://robwise.github.io/blog/jekyll-and-gulp&quot;&gt;Rob’s post&lt;/a&gt;
and is a great organization technique. In the &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; directory, I created a
directory called &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp_config&lt;/code&gt; to hold &lt;code class=&quot;highlighter-rouge&quot;&gt;paths.js&lt;/code&gt;, a list of all the paths we’ll
need set to javascript variables to be used in the gulpfile. We’re going to be
piping a lot of files to and from gulp tasks and they’ll need to land in very
specific locations so settings these variables in one place will keep us
consistent.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// paths.js file&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Directory locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// The files Gulp will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;// The files Jekyll will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// The asset files Jekyll will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_site/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// The resulting static site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_site/assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// The resulting static site&#39;s assets.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Folder naming conventions.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postFolderName&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_posts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draftFolderName&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_drafts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;img&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Asset files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Jekyll files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draftFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Site files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Glob patterns by file type.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassPattern&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.+(jpg|JPG|jpeg|JPEG|png|PNG|svg|SVG|gif|GIF|webp|WEBP|tif|TIF)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.+(md|MD|markdown|MARKDOWN)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.html&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xmlPattern&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.xml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Asset files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFilesGlob&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Jekyll files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllHtmlFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllXmlFilesGlob&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Site files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteHtmlFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Later we’ll include this file in our gulpfile so the variables can be accessed.&lt;/p&gt;

&lt;h3 id=&quot;install-dependencies&quot;&gt;Install dependencies&lt;/h3&gt;

&lt;p&gt;The first requirements are node.js and npm, which you can learn about installing &lt;a href=&quot;https://docs.npmjs.com/getting-started/installing-node&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Getting gulp set up is a matter of a few commands:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Install gulp globally.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; gulp

&lt;span class=&quot;c&quot;&gt;# Initialize the project, following the prompts&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (most of which can be left blank and filled in later).&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm init

&lt;span class=&quot;c&quot;&gt;# Now that package.json has been created, start adding dependencies.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;--save-dev&lt;/span&gt; gulp

&lt;span class=&quot;c&quot;&gt;# Create a gulpfile in the root of the repository.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;touch gulpfile.js
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;set-variables-and-include-paths&quot;&gt;Set variables and include paths&lt;/h3&gt;

&lt;p&gt;In the gulpfile, we’ll start by setting up variables for the gulp plugins we’ll
be using and including our paths file.&lt;/p&gt;

&lt;p&gt;(P.S. If you’re like me, you might find it easier to look at the entire gulpfile
at once - you can view ours &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/926c11c60eeb774b9644fb72ee1e8383e3a09bb8/gulpfile.js&quot;&gt;on GitHub&lt;/a&gt;.)&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// gulpfile.js&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Define variables.&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;autoprefixer&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;browser-sync&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-clean-css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-concat&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;del&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-util&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;imagemin&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-imagemin&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-notify&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-postcss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rename&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-rename&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-run&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;runSequence&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;run-sequence&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-ruby-sass&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;uglify&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-uglify&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Include paths file.&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;./_assets/gulp_config/paths&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Each plugin will need to be installed locally either by copying our
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/84ff592ff2fc8c9bf57b1226c76df66bb9d53b25/gulpfile.js&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;packages.json&lt;/code&gt;&lt;/a&gt;
file and running &lt;code class=&quot;highlighter-rouge&quot;&gt;npm install&lt;/code&gt;, or by running the following for each
plugin:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;--save-dev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;plugin-name]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will install the package and add it to the &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt; file.&lt;/p&gt;

&lt;h2 id=&quot;gulp-tasks&quot;&gt;Gulp tasks&lt;/h2&gt;

&lt;p&gt;Below is an outline of the gulp tasks we’ll be writing. From here, I’ll go
through each individual task, then the default &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; commands
that tie the tasks together to build the site or serve it locally.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// gulpfile.js&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Processes SCSS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Compile SCSS, run autoprefixer, and minify CSS.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Creates critical CSS file.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Compile critical SCSS rules, run autoprefixer, minify CSS, and place in&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// appropriate location so it can be inlined in the HTML head.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Processes JS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Concatenate and uglify JS.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Optimizes images.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run imagemin.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run bundle exec jekyll build with appropriate config file.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Builds site anew.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run all build tasks.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Default Task: builds site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;default&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Serves site and watches files.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;serve&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Watch for changes and run appropriate build tasks when needed.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;handle-css&quot;&gt;Handle CSS&lt;/h3&gt;

&lt;p&gt;Jekyll compiles SCSS out of the box, but using gulp to process our SCSS gives us the power to do other useful things like minify our CSS, add vendor prefixes, and direct our critical CSS to the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;head&amp;gt;&lt;/code&gt; element.&lt;/p&gt;

&lt;h4 id=&quot;process-all-scss&quot;&gt;Process all SCSS&lt;/h4&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Uses Sass compiler to process styles, adds vendor prefixes, minifies, then&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// outputs file to the appropriate location.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/main.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;compressed&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;loadPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;last 2 versions&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task will output &lt;code class=&quot;highlighter-rouge&quot;&gt;main.css&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/styles&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Some notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;We’re including all our SCSS partials in our &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/220e13c1878b5f2b168d941463ad9d6a332f741a/_assets/styles/main.scss&quot;&gt;main.scss&lt;/a&gt;
file, but you could point to a directory or file glob if needed.&lt;/li&gt;
  &lt;li&gt;We’re using the &lt;a href=&quot;https://github.com/postcss/autoprefixer&quot;&gt;autoprefixer plugin&lt;/a&gt; for postcss. We’re making heavy use of the Bourbon mixin library which currently handles some autoprefixing, but this will be dropped (hopefully soon!) in Bourbon v5.0 at which time &lt;a href=&quot;https://github.com/postcss/autoprefixer&quot;&gt;autoprefixer will be recommended&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;critical-css&quot;&gt;Critical CSS&lt;/h4&gt;

&lt;p&gt;Placing the CSS that’s critical to above-the-fold content in &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;style&amp;gt;&lt;/code&gt; tags in
the HTML &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;head&amp;gt;&lt;/code&gt; to means our end user can avoid waiting on the server to load
the full CSS file on the initial page load. Identifying critical styles and
pulling them into a single file may seem daunting but there are a
&lt;a href=&quot;https://css-tricks.com/authoring-critical-fold-css/#article-header-id-1&quot;&gt;number of ways&lt;/a&gt;
to do this automatically. However, we found the easiest way to consolidate
critical styles for all pages on our site was to follow
&lt;a href=&quot;https://gomakethings.com/inlining-critical-css-for-better-web-performance/&quot;&gt;Chris Ferdinandi’s method&lt;/a&gt;
and separate critical styles into their own Sass partials, then include these
partials in a &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.scss&lt;/code&gt; file. This took a
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/commit/53b6d3edbace9ca7a85bd3d3d2e02e88087862b0&quot;&gt;little refactoring&lt;/a&gt;,
but it certainly didn’t hurt to make our Sass files even more modular.&lt;/p&gt;

&lt;p&gt;After we created our &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.scss&lt;/code&gt; file, we added another gulp task to process
it:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Processes critical CSS, to be included in head.html.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/critical.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;compressed&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;loadPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;last 2 versions&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_includes&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This outputs a (git-ignored) &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.css&lt;/code&gt; file into our &lt;code class=&quot;highlighter-rouge&quot;&gt;_includes&lt;/code&gt; directory.
We added the critical CSS file to our &lt;code class=&quot;highlighter-rouge&quot;&gt;head.html&lt;/code&gt; template:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in head.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  
  {# Other stuff... #}

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;critical.css&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
  
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;load-css-asynchronously&quot;&gt;Load CSS asynchronously&lt;/h4&gt;

&lt;p&gt;Next, instead of loading the main CSS file all at once, we used
&lt;a href=&quot;https://github.com/filamentgroup/loadCSS&quot;&gt;Filament Group’s &lt;code class=&quot;highlighter-rouge&quot;&gt;loadCSS&lt;/code&gt; function&lt;/a&gt;
to load the main CSS asynchronously (plus our Google fonts):&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in head.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  
  {# Other stuff... #}

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;use strict&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;removeEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;all&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;head&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;childNodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;styleSheets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;only x&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parentNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;insertBefore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nextSibling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)});&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})};&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onloadcssdefined&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;undefined&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;undefined&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;relpreload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;support&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;relList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;supports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;preload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){}},&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;preload&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;style&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;as&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}},&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;support&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;clearInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})}}}(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;critical.css&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
  
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a fallback, we’re loading the CSS files normally in &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/code&gt; tags
in a &lt;code class=&quot;highlighter-rouge&quot;&gt;scripts.html&lt;/code&gt; template that’s included on each page after the footer.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in scripts.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;tasks-to-build-all-styles-and-delete-all-styles&quot;&gt;Tasks to build all styles and delete all styles&lt;/h4&gt;

&lt;p&gt;To wrap things up, we have a task to build all styles, and a task to delete all
styles. These will come into play when we set up our main build and serve tasks.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Builds all styles.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes CSS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#39;_includes/critical.css&#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;process-js-and-load-it-asynchronously&quot;&gt;Process JS and load it asynchronously&lt;/h3&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Concatenates and uglifies global JS files and outputs result to the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// appropriate location.&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
         &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/global/lib&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/global/*.js&#39;&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uglify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task outputs &lt;code class=&quot;highlighter-rouge&quot;&gt;main.js&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/js/main.js&lt;/code&gt;. To avoid delaying the
initial render, we’re loading the scripts asynchronously via the &lt;code class=&quot;highlighter-rouge&quot;&gt;async&lt;/code&gt;
attribute in our &lt;code class=&quot;highlighter-rouge&quot;&gt;scripts.html&lt;/code&gt; template included on each page after the footer.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in scripts.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://savaslabs.com/assets/js/main.js&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;async&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As before, we also have a task to delete all processed scripts.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Deletes processed JS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;copy-fonts&quot;&gt;Copy fonts&lt;/h3&gt;

&lt;p&gt;I’ll quickly note that we set up a task to copy our fonts to the appropriate
directory, but we’re only doing this with Font Awesome at the moment.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Copies fonts.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;fontawesome&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Places Font Awesome fonts in proper location.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;fontawesome&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/font-awesome/**.*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dirname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;}))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes processed fonts.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;process-images&quot;&gt;Process images&lt;/h3&gt;

&lt;p&gt;We took a few steps to optimize our site’s existing images and ensure that
future images could be optimized automatically via gulp and the Jekyll build
process.&lt;/p&gt;

&lt;h4 id=&quot;manual-updates-to-images&quot;&gt;Manual updates to images&lt;/h4&gt;

&lt;p&gt;We knocked out some low-hanging fruit by ensuring we were using the proper image
formats and the smallest images possible. Google has a &lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/image-optimization&quot;&gt;great writeup on image
optimization&lt;/a&gt;
that I’d highly recommend reading, but the gist is:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Don’t use images if you can use CSS or webfonts&lt;/li&gt;
  &lt;li&gt;Choose the right image format:
    &lt;ul&gt;
      &lt;li&gt;If it’s a vector graphic or can be converted to one, use SVG&lt;/li&gt;
      &lt;li&gt;If you need transparency or fine detail, use PNG&lt;/li&gt;
      &lt;li&gt;If you need animation, use GIF&lt;/li&gt;
      &lt;li&gt;Otherwise, use JPEG&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Play around with image quality to find the lowest quality that still looks great&lt;/li&gt;
  &lt;li&gt;Your images shouldn’t be any larger than the largest they’ll display on your
site (keeping in mind this might be 2x for high resolution displays)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;On my Mac, I used &lt;a href=&quot;https://www.sketchapp.com/&quot;&gt;Sketch&lt;/a&gt; to convert some of our
images from PNG to JPEG at a slightly lower quality, to save vector graphics as
SVGs when possible, and to trim images down when they were larger than they
needed to be. We also established these rules as a team for future images to be
added to our site.&lt;/p&gt;

&lt;h4 id=&quot;minify-images-via-gulp&quot;&gt;Minify images via gulp&lt;/h4&gt;

&lt;p&gt;Next, we wrote a gulp task to run our images through the &lt;code class=&quot;highlighter-rouge&quot;&gt;imagemin&lt;/code&gt; plugin.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Optimizes and copies image files.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFilesGlob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagemin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task outputs optimized images in &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/img&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We also have a task to delete all processed images.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Deletes processed images.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;jekyll-picture-tag-plugin&quot;&gt;Jekyll Picture Tag plugin&lt;/h4&gt;

&lt;p&gt;Between our manual updates and &lt;code class=&quot;highlighter-rouge&quot;&gt;imagemin&lt;/code&gt;, we cut our image sizes down
drastically! Our next step was to set up the
&lt;a href=&quot;https://github.com/robwierzbowski/jekyll-picture-tag&quot;&gt;Jekyll Picture Tag plugin&lt;/a&gt;.
This plugin supplies a Liquid tag to insert a &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element, which
allows the browser to choose the most appropriate image from an array of sizes.
Since our sites are viewed on so many different devices, we need to send these
devices images that make sense — loading a huge image meant for a large retina
screen on a tiny mobile phone is a waste of time and resources. The Liquid
tag provided by the plugin is much simpler than typing out all the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt;
markup, and the plugin also generates the differently sized images based on some
simple config. Since the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element has very low browser support at
this time, &lt;a href=&quot;https://github.com/scottjehl/picturefill&quot;&gt;Picturefill&lt;/a&gt; is used as a
polyfill, meaning the resulting markup will work in all modern browsers.&lt;/p&gt;

&lt;p&gt;But wait - how can we use a Jekyll plugin while we’re hosting our site on GitHub
Pages? GitHub Pages only allows
&lt;a href=&quot;https://pages.github.com/versions/&quot;&gt;a few Jekyll plugins&lt;/a&gt; when it builds a site
for deployment, a well-known limitation. &lt;a href=&quot;/2016/10/25/deploy-jekyll-with-travis.html&quot;&gt;Read about how we’re using Travis CI
to build our site for testing and deployment to GitHub Pages so we can use
Jekyll plugins.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/robwierzbowski/jekyll-picture-tag#installation&quot;&gt;installation and usage&lt;/a&gt;
documentation on Jekyll Picture Tag’s GitHub repo is great, and setup is a quick
matter of installing the gem and the Picturefill script. From there, we set up
presets for repeated image styles on our site - team photos, featured
blog images, etc.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# in config.yml&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Picture element presets&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;assets/img&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;assets/processed-img&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;markup&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;picture&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;presets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_square&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-square&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;334&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;254&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_individual&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-individual&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;350&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;288&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_post_meta&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-post-meta&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;288&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;case_study&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--case-study&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_860&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;860px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;560&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_640&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;640px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;430&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;560&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;post_featured_image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--post-featured-image&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_1120&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;737&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;First we set the source directory to &lt;code class=&quot;highlighter-rouge&quot;&gt;assets/img&lt;/code&gt;, which is where images are
sent by gulp after being optimized. Resized images will be output to
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets/processed-img&lt;/code&gt;. Keep in mind that since this is being done during the
&lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; process, the processed image directory will be inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory.&lt;/p&gt;

&lt;p&gt;Each preset has the following configured:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A &lt;a href=&quot;http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/&quot;&gt;BEM&lt;/a&gt;-style
class (other attributes can be added too).&lt;/li&gt;
  &lt;li&gt;An array of resolutions. &lt;code class=&quot;highlighter-rouge&quot;&gt;[1, 2]&lt;/code&gt; will generate images at 1 and 2 times the
specified dimensions, and the double-sized image will be served on devices with
a resolution of at least 2 dots per pixel (better known as Retina screens).&lt;/li&gt;
  &lt;li&gt;Source specifications. Each source contains a media query and a width to be
used at that screen size (I didn’t include height so the images will be scaled
proportionally).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From here we use a simple Liquid tag to create the markup. For our
individual team member pages we insert the team member’s photo with:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
{% picture team_individual {{ page.photo }} alt=&quot;{{ page.name }}&quot; %}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We’re using the &lt;code class=&quot;highlighter-rouge&quot;&gt;team_individual&lt;/code&gt; preset, so four versions of the image will be
created (two at each specified width, and two images at double those dimensions
for hi-res displays). The markup ends up like this:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;picture&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-700by710-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(min-width: 400px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 400px) and (min-resolution: 192dpi)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-350by355-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(min-width: 400px)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-576by584-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;image--team-individual&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;image&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;alt=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Anne Tomasevich&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/picture&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With some easy setup, we’re cutting down drastically on the sizes of images
served at smaller screen sizes and lower resolutions!&lt;/p&gt;

&lt;h4 id=&quot;background-images&quot;&gt;Background images&lt;/h4&gt;

&lt;p&gt;One place we couldn’t use this plugin is for images displayed via the CSS
&lt;code class=&quot;highlighter-rouge&quot;&gt;background-image&lt;/code&gt; property, which we’re using for some hero images. For the
large image on the home page, I manually created a variety of images (known in
the responsive image world as &lt;a href=&quot;https://developers.google.com/web/fundamentals/design-and-ui/media/images#art_direction&quot;&gt;art direction&lt;/a&gt;)
then used media queries to display the appropriate image as the background image.
You can check out the &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/e61687f846a2ee605a5141cb9fa8a16c2de28339/_assets/styles/scss/components/_home-cover-image.scss&quot;&gt;SCSS on GitHub&lt;/a&gt;.
Since this is a much more time-consuming process I haven’t implemented this for
all of our background images yet, but taking the time to create images that will
look exactly how we want them at all screen sizes will be well worth it!&lt;/p&gt;

&lt;h3 id=&quot;build-and-serve-tasks&quot;&gt;Build and serve tasks&lt;/h3&gt;

&lt;p&gt;To pull it all together, we have a default task to build the site (creating the
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory which holds the compiled HTML, CSS, JS, and images that comprise our site)
and a &lt;code class=&quot;highlighter-rouge&quot;&gt;serve&lt;/code&gt; task to watch our files and rebuild the appropriate files or the
entire site when those files change.&lt;/p&gt;

&lt;p&gt;The default task deletes the site by running the &lt;code class=&quot;highlighter-rouge&quot;&gt;clean&lt;/code&gt; tasks then runs all the
&lt;code class=&quot;highlighter-rouge&quot;&gt;build&lt;/code&gt; tasks, then the &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; command to build the site using our
processed assets.&lt;/p&gt;

&lt;p&gt;A little gulp tip: tasks passed within square brackets are run concurrently (one
of the major advantages of using gulp over Grunt, which can only run one task at
a time), while items in a comma-separated list are run sequentially. We’ll need
this to run the build tasks in the correct order since we need to create our
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory before running &lt;code class=&quot;highlighter-rouge&quot;&gt;build:jekyll&lt;/code&gt;, which will copy &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; to
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes the entire _site directory.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_site&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Main clean task.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Deletes _site directory and processed assets.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Builds site anew.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;runSequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Default Task: builds site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;default&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp&lt;/code&gt; will run the default task &lt;code class=&quot;highlighter-rouge&quot;&gt;build&lt;/code&gt; and will build the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory. This is what we want in production, but let’s go back to our three
separate Jekyll configuration files. We want to create gulp tasks using
&lt;code class=&quot;highlighter-rouge&quot;&gt;config.test.yml&lt;/code&gt; for running our test script and &lt;code class=&quot;highlighter-rouge&quot;&gt;config.dev.yml&lt;/code&gt; for local
development.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command using test config.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:test&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml,_config.test.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command using local config.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml,_config.test.yml,_config.dev.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The last thing we needed is a gulp command to serve the site and watch for file
changes. To accomplish this we’re using &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp.watch()&lt;/code&gt;, which tells gulp to run
a specified task if the targeted files are changed. We also created a couple of
special tasks to tell the browser to reload the served site on changes to Jekyll
files (templates, config, etc.) or Javascript files. We already included
&lt;code class=&quot;highlighter-rouge&quot;&gt;.pipe(browserSync.stream())&lt;/code&gt; in our &lt;code class=&quot;highlighter-rouge&quot;&gt;build:styles:main&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;build:images&lt;/code&gt; tasks, so
when these files are updated the changes will be injected into our local site
and we won’t even need a refresh.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Special tasks for building and then reloading BrowserSync.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Static Server + watching files.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Note: passing anything besides hard-coded literal paths with globs doesn&#39;t&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// seem to work with gulp.watch().&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;serve&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;ghostMode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Toggle to mirror clicks, reloads etc. (performance)&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;logFileChanges&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;logLevel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;debug&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// Toggle to automatically open page when starting.&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch site settings.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_config.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch .scss files; changes are piped to browserSync.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/styles/**/*.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch .js files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/js/**/*.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch image files; changes are piped to browserSync.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/img/**/*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch posts.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_posts/**/*.+(md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch drafts if --drafts flag was passed.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drafts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_drafts/*.+(md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch html and markdown files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;**/*.+(html|md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;!_site/**/*.*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch RSS feed XML file.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;feed.xml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch data files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_data/**.*+(yml|yaml|csv|json)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch favicon.png.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;favicon.png&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this, we can run &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; to fire up our site locally. The initial
build takes a bit longer than &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt; but the convenience of
automatically opening a browser window, automatic refreshing, and new CSS being
injected is fantastic!&lt;/p&gt;

&lt;h2 id=&quot;the-results&quot;&gt;The Results&lt;/h2&gt;

&lt;p&gt;After implementing these changes, our mobile PageSpeed score shot up to 92/100,
with our desktop score at 95/100!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/pagespeed-insights-results.jpg&quot; alt=&quot;95/100 Google PageSpeed Insights score!&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;To pat ourselves on the back a little more, I should mention that we were already
doing great in the user experience department.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/pagespeed-insights-user-experience.jpg&quot; alt=&quot;Passing Google PageSpeed Insights user experience items.&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;That’s grounds for a little celebration in my opinion!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/liz-lemon-self-five.gif&quot; class=&quot;blog-image&quot; style=&quot;max-width: 300px;&quot; alt=&quot;Tina Fey as Liz Lemon giving herself an awesome high five.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In addition to improving performance on our existing site, we now have a
framework in place to ensure good performance in the future — using gulp to
build the site for production will automatically optimize our CSS, JS, and image
assets. Plus, our local development workflow is more streamlined both because
we took the time to think through our asset pipeline and because we can
capitalize on tools like Browsersync to enhance the development experience.&lt;/p&gt;

&lt;h2 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h2&gt;

&lt;p&gt;There are a couple things I’d like to improve with this process:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Once an image is optimized via imagemin it shouldn’t be processed each time
&lt;code class=&quot;highlighter-rouge&quot;&gt;build:images&lt;/code&gt; runs. By doing this, we’ll save time both when building the site
for testing and deployment and for spinning up the site locally.&lt;/li&gt;
  &lt;li&gt;Similarly, once an image is processed by Jekyll Picture Tag it doesn’t need to
be re-processed on every run of &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;further-resources&quot;&gt;Further Resources&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://aaronlasseigne.com/2016/02/03/using-gulp-with-jekyll/&quot;&gt;Aaron Lasseigne’s take on gulp + Jekyll&lt;/a&gt;,
which breaks down the gulp tasks nicely&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.smashingmagazine.com/2014/06/building-with-gulp/&quot;&gt;Smashing Magazine’s deep dive into gulp&lt;/a&gt;,
a must-read for gulp beginners!&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.smashingmagazine.com/2014/05/responsive-images-done-right-guide-picture-srcset/&quot;&gt;Smashing Magazine’s guide to the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
",
      "author": {
        "@context": "http://schema.org",
        "@type": "Person",
        "name": "Anne Tomasevich",
        "affiliation": "Savas Labs",
        "worksFor": "Savas Labs"
      },
      "dateCreated": "2016-10-19 00:00:00 +0000",
      "dateModified": "2016-10-19 00:00:00 +0000",
      "datePublished": "2016-10-19 00:00:00 +0000",
      "headline": "Optimizing Jekyll Performance with Gulp",
      "image": {
        "@context": "http://schema.org",
        "@type": "ImageObject",
        "author": "Anne Tomasevich",
        "datePublished": "2016-10-19 00:00:00 +0000",
        "description": "Test tubes with brightly color liquids inside",
        "height": "912px",
        "url": "https://savaslabs.com/assets/img/blog/test-tubes.jpg",
        "width": "1474px"
      },
      "inLanguage": "en-US",
      "keywords": "performance, jekyll, javascript, css, sass, front-end-dev",
      "mainEntityOfPage": "https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html",
      "publisher": {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Durham",
          "addressRegion": "NC",
          "postalCode": "27701",
          "streetAddress": "201 W Main St."
        },
        "description": "We design digital products that users love
",
        "email": "info@savaslabs.com",
        "logo": {
          "@context": "http://schema.org",
          "@type": "ImageObject",
          "description": "Savas Labs logo",
          "height": "50px",
          "url": "https://savaslabs.com/assets/img/logo.png",
          "width": "114px"
        },
        "name": "Savas Labs",
        "telephone": "(919) 432-4660",
        "url": "https://savaslabs.com"
      },
      "sourceOrganization": "Savas Labs",
      "text": "&lt;p&gt;It’s hard to believe it’s been over a year and a half since our site’s &lt;a href=&quot;https://savaslabs.com/2015/04/01/building-our-site.html&quot;&gt;inaugural blog post&lt;/a&gt; (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll&lt;/code&gt; commands to build the site. Instead, we’re using &lt;a href=&quot;http://gulpjs.com/&quot;&gt;gulp&lt;/a&gt;, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!&lt;/p&gt;

&lt;p&gt;We based a lot of our gulp workflow on
&lt;a href=&quot;https://robwise.github.io/blog/jekyll-and-gulp&quot;&gt;this excellent post&lt;/a&gt; by Rob Wise.
Our workflow includes a few additional features like:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Separate gulp tasks for building the site locally,
for testing purposes, and for production&lt;/li&gt;
  &lt;li&gt;Some updated gulp plugins&lt;/li&gt;
  &lt;li&gt;Inlining of critical CSS&lt;/li&gt;
  &lt;li&gt;Some further improvements to responsive images&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;…but I’d definitely recommend his post and you’ll see some of his code and
architecture throughout this article.&lt;/p&gt;

&lt;p&gt;To see all of our current code, pop over to our
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io&quot;&gt;GitHub repo&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;We know how important site performance is to
&lt;a href=&quot;http://alistapart.com/article/improving-ux-through-front-end-performance&quot;&gt;user experience&lt;/a&gt;.
We’ve been showing this to our clients for years, and we finally found the time
to be able to practice what we preach!&lt;/p&gt;

&lt;p&gt;Our ultimate motivator was our not-so-great Google PageSpeed score.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://savaslabs.com/assets/img/blog/pagespeed-insights-initial.jpg&quot; alt=&quot;Initial Google PageSpeed Insights score for savaslabs.com. Several significant problems exist!&quot; class=&quot;blog-image-full-width&quot; /&gt;
&lt;span class=&quot;caption&quot;&gt;Yikes!&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Going off of these recommendations and adding a few things of our own, we ended
up with a nice to-do list:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Optimize CSS:
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Minification_(programming)&quot;&gt;Minify&lt;/a&gt; our main
CSS file to remove unnecessary characters and shrink the filesize.&lt;/li&gt;
      &lt;li&gt;Use autoprefixer to add
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Vendor_Prefix&quot;&gt;vendor prefixes&lt;/a&gt;
(since this will be required for the soon-to-come Bourbon v5.0).&lt;/li&gt;
      &lt;li&gt;To prevent our large CSS file from delaying the initial render for the end
user, insert CSS that’s critical to above-the-fold content into the HTML
head. By “above the fold” I mean content viewable to the user on the initial
page load before interacting with the site.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Optimize JS:
    &lt;ul&gt;
      &lt;li&gt;Concatenate and &lt;a href=&quot;https://github.com/mishoo/UglifyJS&quot;&gt;uglify&lt;/a&gt; our JS files
to create a single, minified file, smaller than the larger files we started with.&lt;/li&gt;
      &lt;li&gt;Execute our JS asynchronously, meaning it will be executed when it’s ready
while the page is loading without interfering with the render.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Optimize images:
    &lt;ul&gt;
      &lt;li&gt;Manually shrink our image file sizes, then set up gulp to
&lt;a href=&quot;https://github.com/imagemin/imagemin&quot;&gt;optimize&lt;/a&gt; them even further for the
smallest images possible.&lt;/li&gt;
      &lt;li&gt;Use the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element over simple &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;img&amp;gt;&lt;/code&gt; tags. The &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt;
 element contains an array of different sizes of the same image and allows
 the browser to pick the smallest one that will look good on the user’s
 screen size and resolution, so only the smallest possible image is loaded.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;One thing reported by PageSpeed not yet on our to-do list is “leverage
browser caching” — we’re not going to tackle this just yet since we’re using
GitHub Pages to host our site and we don’t have control over caching headers. On
a side note, if you have a solution to this problem, please leave us a comment!&lt;/p&gt;

&lt;p&gt;From here I’ll go over how we set up gulp to work with our Jekyll site, then how
we used gulp to accomplish the tasks above.&lt;/p&gt;

&lt;h2 id=&quot;initial-setup&quot;&gt;Initial setup&lt;/h2&gt;

&lt;h3 id=&quot;changes-to-jekyll-directory-structure&quot;&gt;Changes to Jekyll directory structure&lt;/h3&gt;

&lt;p&gt;Our fonts, images, scripts, and SCSS files were previously stored in a directory
called &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt;. The &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; command would copy this directory into the
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; folder so the assets within could be included in HTML files and used to
theme the site.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~/Sites/savaslabs.com/assets &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tree &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; 1
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
├── fonts
├── img
├── js
└── styles
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since we’re going to be processing our assets with gulp instead, we moved the
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory to &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; to indicate that it should be ignored by Jekyll.&lt;/p&gt;

&lt;p&gt;Our basic workflow is to use gulp to process the contents of &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt;,
outputting them into a git-ignored directory &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; which will be copied by
Jekyll into the generated &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory. In addition, for local development
we created a &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; task using &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp.watch()&lt;/code&gt; to process assets as
they’re updated and copy them directly into the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory, then push the
changes to the browser via BrowserSync.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://savaslabs.com/assets/img/blog/gulp-workflow.svg&quot; alt=&quot;Diagram of our basic gulp workflow&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;changes-to-jekyll-config&quot;&gt;Changes to Jekyll config&lt;/h3&gt;

&lt;p&gt;We also needed to make some updates to our Jekyll config:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Delete this since Jekyll is no longer processing sass.&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;sass_dir&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;assets/styles&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Exclude the following from the Jekyll build process.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Note: &quot;vendor&quot; is for Travis CI.&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;exclude&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;vendor&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;_assets&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Gemfile&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Gemfile.lock&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;gulpfile.js&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;node_modules&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;package.json&quot;&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I’d also like to note that we’re using a few different config files: our default
&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.test.yml&lt;/code&gt; which uses blank URL and base URL variables so
tests can be run locally, and &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.dev.yml&lt;/code&gt; which sets variables for our
local &lt;a href=&quot;https://github.com/savaslabs/squabble&quot;&gt;comment server&lt;/a&gt; for development
purposes. These different config files will come into play as we set up the
gulpfile.&lt;/p&gt;

&lt;p&gt;Finally, we updated our &lt;code class=&quot;highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; to include the following:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# .gitignore
node_modules
assets
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;node_modules&lt;/code&gt; will hold all of our node.js dependencies, and &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; is the
directory that will be generated by gulp and copied by Jekyll into the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory. The &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory (no underscore) will hold processed asset
files and we’ll only be keeping the unprocessed files (the &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; directory)
in version control.&lt;/p&gt;

&lt;h3 id=&quot;paths-file&quot;&gt;Paths file&lt;/h3&gt;

&lt;p&gt;This comes straight from &lt;a href=&quot;https://robwise.github.io/blog/jekyll-and-gulp&quot;&gt;Rob’s post&lt;/a&gt;
and is a great organization technique. In the &lt;code class=&quot;highlighter-rouge&quot;&gt;_assets&lt;/code&gt; directory, I created a
directory called &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp_config&lt;/code&gt; to hold &lt;code class=&quot;highlighter-rouge&quot;&gt;paths.js&lt;/code&gt;, a list of all the paths we’ll
need set to javascript variables to be used in the gulpfile. We’re going to be
piping a lot of files to and from gulp tasks and they’ll need to land in very
specific locations so settings these variables in one place will keep us
consistent.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// paths.js file&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Directory locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// The files Gulp will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;// The files Jekyll will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// The asset files Jekyll will handle.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_site/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// The resulting static site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_site/assets/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// The resulting static site&#39;s assets.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Folder naming conventions.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postFolderName&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_posts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draftFolderName&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;_drafts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;img&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Asset files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Jekyll files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draftFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Site files locations.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stylesFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteAssetsDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFolderName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Glob patterns by file type.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassPattern&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.+(jpg|JPG|jpeg|JPEG|png|PNG|svg|SVG|gif|GIF|webp|WEBP|tif|TIF)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.+(md|MD|markdown|MARKDOWN)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.html&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xmlPattern&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/**/*.xml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Asset files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFilesGlob&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Jekyll files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllPostFiles&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDraftFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdownPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllHtmlFilesGlob&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllXmlFilesGlob&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllDir&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagePattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Site files globs&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteHtmlFilesGlob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;htmlPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Later we’ll include this file in our gulpfile so the variables can be accessed.&lt;/p&gt;

&lt;h3 id=&quot;install-dependencies&quot;&gt;Install dependencies&lt;/h3&gt;

&lt;p&gt;The first requirements are node.js and npm, which you can learn about installing &lt;a href=&quot;https://docs.npmjs.com/getting-started/installing-node&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Getting gulp set up is a matter of a few commands:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Install gulp globally.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; gulp

&lt;span class=&quot;c&quot;&gt;# Initialize the project, following the prompts&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (most of which can be left blank and filled in later).&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm init

&lt;span class=&quot;c&quot;&gt;# Now that package.json has been created, start adding dependencies.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;--save-dev&lt;/span&gt; gulp

&lt;span class=&quot;c&quot;&gt;# Create a gulpfile in the root of the repository.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;touch gulpfile.js
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;set-variables-and-include-paths&quot;&gt;Set variables and include paths&lt;/h3&gt;

&lt;p&gt;In the gulpfile, we’ll start by setting up variables for the gulp plugins we’ll
be using and including our paths file.&lt;/p&gt;

&lt;p&gt;(P.S. If you’re like me, you might find it easier to look at the entire gulpfile
at once - you can view ours &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/926c11c60eeb774b9644fb72ee1e8383e3a09bb8/gulpfile.js&quot;&gt;on GitHub&lt;/a&gt;.)&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// gulpfile.js&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Define variables.&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;autoprefixer&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;browser-sync&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-clean-css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-concat&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;del&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-util&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;imagemin&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-imagemin&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-notify&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-postcss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rename&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-rename&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-run&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;runSequence&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;run-sequence&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-ruby-sass&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;uglify&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;gulp-uglify&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Include paths file.&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;./_assets/gulp_config/paths&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Each plugin will need to be installed locally either by copying our
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/84ff592ff2fc8c9bf57b1226c76df66bb9d53b25/gulpfile.js&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;packages.json&lt;/code&gt;&lt;/a&gt;
file and running &lt;code class=&quot;highlighter-rouge&quot;&gt;npm install&lt;/code&gt;, or by running the following for each
plugin:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm install &lt;span class=&quot;nt&quot;&gt;--save-dev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;plugin-name]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will install the package and add it to the &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt; file.&lt;/p&gt;

&lt;h2 id=&quot;gulp-tasks&quot;&gt;Gulp tasks&lt;/h2&gt;

&lt;p&gt;Below is an outline of the gulp tasks we’ll be writing. From here, I’ll go
through each individual task, then the default &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; commands
that tie the tasks together to build the site or serve it locally.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// gulpfile.js&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Processes SCSS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Compile SCSS, run autoprefixer, and minify CSS.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Creates critical CSS file.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Compile critical SCSS rules, run autoprefixer, minify CSS, and place in&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// appropriate location so it can be inlined in the HTML head.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Processes JS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Concatenate and uglify JS.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Optimizes images.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run imagemin.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run bundle exec jekyll build with appropriate config file.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Builds site anew.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Run all build tasks.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Default Task: builds site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;default&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Serves site and watches files.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;serve&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Watch for changes and run appropriate build tasks when needed.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;handle-css&quot;&gt;Handle CSS&lt;/h3&gt;

&lt;p&gt;Jekyll compiles SCSS out of the box, but using gulp to process our SCSS gives us the power to do other useful things like minify our CSS, add vendor prefixes, and direct our critical CSS to the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;head&amp;gt;&lt;/code&gt; element.&lt;/p&gt;

&lt;h4 id=&quot;process-all-scss&quot;&gt;Process all SCSS&lt;/h4&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Uses Sass compiler to process styles, adds vendor prefixes, minifies, then&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// outputs file to the appropriate location.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/main.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;compressed&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;loadPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;last 2 versions&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task will output &lt;code class=&quot;highlighter-rouge&quot;&gt;main.css&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/styles&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Some notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;We’re including all our SCSS partials in our &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/220e13c1878b5f2b168d941463ad9d6a332f741a/_assets/styles/main.scss&quot;&gt;main.scss&lt;/a&gt;
file, but you could point to a directory or file glob if needed.&lt;/li&gt;
  &lt;li&gt;We’re using the &lt;a href=&quot;https://github.com/postcss/autoprefixer&quot;&gt;autoprefixer plugin&lt;/a&gt; for postcss. We’re making heavy use of the Bourbon mixin library which currently handles some autoprefixing, but this will be dropped (hopefully soon!) in Bourbon v5.0 at which time &lt;a href=&quot;https://github.com/postcss/autoprefixer&quot;&gt;autoprefixer will be recommended&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;critical-css&quot;&gt;Critical CSS&lt;/h4&gt;

&lt;p&gt;Placing the CSS that’s critical to above-the-fold content in &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;style&amp;gt;&lt;/code&gt; tags in
the HTML &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;head&amp;gt;&lt;/code&gt; to means our end user can avoid waiting on the server to load
the full CSS file on the initial page load. Identifying critical styles and
pulling them into a single file may seem daunting but there are a
&lt;a href=&quot;https://css-tricks.com/authoring-critical-fold-css/#article-header-id-1&quot;&gt;number of ways&lt;/a&gt;
to do this automatically. However, we found the easiest way to consolidate
critical styles for all pages on our site was to follow
&lt;a href=&quot;https://gomakethings.com/inlining-critical-css-for-better-web-performance/&quot;&gt;Chris Ferdinandi’s method&lt;/a&gt;
and separate critical styles into their own Sass partials, then include these
partials in a &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.scss&lt;/code&gt; file. This took a
&lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/commit/53b6d3edbace9ca7a85bd3d3d2e02e88087862b0&quot;&gt;little refactoring&lt;/a&gt;,
but it certainly didn’t hurt to make our Sass files even more modular.&lt;/p&gt;

&lt;p&gt;After we created our &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.scss&lt;/code&gt; file, we added another gulp task to process
it:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Processes critical CSS, to be included in head.html.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/critical.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;compressed&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;loadPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sassFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postcss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autoprefixer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;last 2 versions&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cleancss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_includes&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This outputs a (git-ignored) &lt;code class=&quot;highlighter-rouge&quot;&gt;critical.css&lt;/code&gt; file into our &lt;code class=&quot;highlighter-rouge&quot;&gt;_includes&lt;/code&gt; directory.
We added the critical CSS file to our &lt;code class=&quot;highlighter-rouge&quot;&gt;head.html&lt;/code&gt; template:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in head.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  
  {# Other stuff... #}

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;critical.css&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
  
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;load-css-asynchronously&quot;&gt;Load CSS asynchronously&lt;/h4&gt;

&lt;p&gt;Next, instead of loading the main CSS file all at once, we used
&lt;a href=&quot;https://github.com/filamentgroup/loadCSS&quot;&gt;Filament Group’s &lt;code class=&quot;highlighter-rouge&quot;&gt;loadCSS&lt;/code&gt; function&lt;/a&gt;
to load the main CSS asynchronously (plus our Google fonts):&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in head.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  
  {# Other stuff... #}

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;use strict&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;removeEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;all&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;head&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;childNodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;styleSheets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;only x&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parentNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;insertBefore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nextSibling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)});&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})};&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onloadcssdefined&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;undefined&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;undefined&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;relpreload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;support&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;relList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;supports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;preload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){}},&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;preload&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;style&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;as&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}},&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;support&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;poly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;load&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;clearInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})}}}(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;loadCSS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;critical.css&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
  
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a fallback, we’re loading the CSS files normally in &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/code&gt; tags
in a &lt;code class=&quot;highlighter-rouge&quot;&gt;scripts.html&lt;/code&gt; template that’s included on each page after the footer.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in scripts.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;tasks-to-build-all-styles-and-delete-all-styles&quot;&gt;Tasks to build all styles and delete all styles&lt;/h4&gt;

&lt;p&gt;To wrap things up, we have a task to build all styles, and a task to delete all
styles. These will come into play when we set up our main build and serve tasks.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Builds all styles.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles:main&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:styles:critical&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes CSS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllCssFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteCssFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.css&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#39;_includes/critical.css&#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;process-js-and-load-it-asynchronously&quot;&gt;Process JS and load it asynchronously&lt;/h3&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Concatenates and uglifies global JS files and outputs result to the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// appropriate location.&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
         &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/global/lib&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsPattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/global/*.js&#39;&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uglify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task outputs &lt;code class=&quot;highlighter-rouge&quot;&gt;main.js&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/js/main.js&lt;/code&gt;. To avoid delaying the
initial render, we’re loading the scripts asynchronously via the &lt;code class=&quot;highlighter-rouge&quot;&gt;async&lt;/code&gt;
attribute in our &lt;code class=&quot;highlighter-rouge&quot;&gt;scripts.html&lt;/code&gt; template included on each page after the footer.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{# in scripts.html #}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://savaslabs.com/assets/js/main.js&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;async&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;/assets/styles/main.css&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;stylesheet&#39;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;text/css&#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As before, we also have a task to delete all processed scripts.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Deletes processed JS.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllJsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteJsFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;copy-fonts&quot;&gt;Copy fonts&lt;/h3&gt;

&lt;p&gt;I’ll quickly note that we set up a task to copy our fonts to the appropriate
directory, but we’re only doing this with Font Awesome at the moment.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Copies fonts.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;fontawesome&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Places Font Awesome fonts in proper location.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;fontawesome&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;/font-awesome/**.*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dirname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;}))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes processed fonts.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteFontFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;process-images&quot;&gt;Process images&lt;/h3&gt;

&lt;p&gt;We took a few steps to optimize our site’s existing images and ensure that
future images could be optimized automatically via gulp and the Jekyll build
process.&lt;/p&gt;

&lt;h4 id=&quot;manual-updates-to-images&quot;&gt;Manual updates to images&lt;/h4&gt;

&lt;p&gt;We knocked out some low-hanging fruit by ensuring we were using the proper image
formats and the smallest images possible. Google has a &lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/image-optimization&quot;&gt;great writeup on image
optimization&lt;/a&gt;
that I’d highly recommend reading, but the gist is:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Don’t use images if you can use CSS or webfonts&lt;/li&gt;
  &lt;li&gt;Choose the right image format:
    &lt;ul&gt;
      &lt;li&gt;If it’s a vector graphic or can be converted to one, use SVG&lt;/li&gt;
      &lt;li&gt;If you need transparency or fine detail, use PNG&lt;/li&gt;
      &lt;li&gt;If you need animation, use GIF&lt;/li&gt;
      &lt;li&gt;Otherwise, use JPEG&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Play around with image quality to find the lowest quality that still looks great&lt;/li&gt;
  &lt;li&gt;Your images shouldn’t be any larger than the largest they’ll display on your
site (keeping in mind this might be 2x for high resolution displays)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;On my Mac, I used &lt;a href=&quot;https://www.sketchapp.com/&quot;&gt;Sketch&lt;/a&gt; to convert some of our
images from PNG to JPEG at a slightly lower quality, to save vector graphics as
SVGs when possible, and to trim images down when they were larger than they
needed to be. We also established these rules as a team for future images to be
added to our site.&lt;/p&gt;

&lt;h4 id=&quot;minify-images-via-gulp&quot;&gt;Minify images via gulp&lt;/h4&gt;

&lt;p&gt;Next, we wrote a gulp task to run our images through the &lt;code class=&quot;highlighter-rouge&quot;&gt;imagemin&lt;/code&gt; plugin.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Optimizes and copies image files.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imageFilesGlob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imagemin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This task outputs optimized images in &lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets/img&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We also have a task to delete all processed images.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Deletes processed images.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jekyllImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteImageFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;jekyll-picture-tag-plugin&quot;&gt;Jekyll Picture Tag plugin&lt;/h4&gt;

&lt;p&gt;Between our manual updates and &lt;code class=&quot;highlighter-rouge&quot;&gt;imagemin&lt;/code&gt;, we cut our image sizes down
drastically! Our next step was to set up the
&lt;a href=&quot;https://github.com/robwierzbowski/jekyll-picture-tag&quot;&gt;Jekyll Picture Tag plugin&lt;/a&gt;.
This plugin supplies a Liquid tag to insert a &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element, which
allows the browser to choose the most appropriate image from an array of sizes.
Since our sites are viewed on so many different devices, we need to send these
devices images that make sense — loading a huge image meant for a large retina
screen on a tiny mobile phone is a waste of time and resources. The Liquid
tag provided by the plugin is much simpler than typing out all the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt;
markup, and the plugin also generates the differently sized images based on some
simple config. Since the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element has very low browser support at
this time, &lt;a href=&quot;https://github.com/scottjehl/picturefill&quot;&gt;Picturefill&lt;/a&gt; is used as a
polyfill, meaning the resulting markup will work in all modern browsers.&lt;/p&gt;

&lt;p&gt;But wait - how can we use a Jekyll plugin while we’re hosting our site on GitHub
Pages? GitHub Pages only allows
&lt;a href=&quot;https://pages.github.com/versions/&quot;&gt;a few Jekyll plugins&lt;/a&gt; when it builds a site
for deployment, a well-known limitation. &lt;a href=&quot;/2016/10/25/deploy-jekyll-with-travis.html&quot;&gt;Read about how we’re using Travis CI
to build our site for testing and deployment to GitHub Pages so we can use
Jekyll plugins.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/robwierzbowski/jekyll-picture-tag#installation&quot;&gt;installation and usage&lt;/a&gt;
documentation on Jekyll Picture Tag’s GitHub repo is great, and setup is a quick
matter of installing the gem and the Picturefill script. From there, we set up
presets for repeated image styles on our site - team photos, featured
blog images, etc.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# in config.yml&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Picture element presets&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;assets/img&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;assets/processed-img&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;markup&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;picture&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;presets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_square&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-square&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;334&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;254&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_individual&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-individual&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;350&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;288&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;team_post_meta&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--team-post-meta&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;288&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;case_study&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--case-study&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_860&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;860px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;560&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_640&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;640px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;430&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;560&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;post_featured_image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image--post-featured-image&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;itemprop&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;image&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ppi&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_1120&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(min-width:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400px)&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;737&quot;&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;source_default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;400&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;First we set the source directory to &lt;code class=&quot;highlighter-rouge&quot;&gt;assets/img&lt;/code&gt;, which is where images are
sent by gulp after being optimized. Resized images will be output to
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets/processed-img&lt;/code&gt;. Keep in mind that since this is being done during the
&lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; process, the processed image directory will be inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory.&lt;/p&gt;

&lt;p&gt;Each preset has the following configured:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A &lt;a href=&quot;http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/&quot;&gt;BEM&lt;/a&gt;-style
class (other attributes can be added too).&lt;/li&gt;
  &lt;li&gt;An array of resolutions. &lt;code class=&quot;highlighter-rouge&quot;&gt;[1, 2]&lt;/code&gt; will generate images at 1 and 2 times the
specified dimensions, and the double-sized image will be served on devices with
a resolution of at least 2 dots per pixel (better known as Retina screens).&lt;/li&gt;
  &lt;li&gt;Source specifications. Each source contains a media query and a width to be
used at that screen size (I didn’t include height so the images will be scaled
proportionally).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From here we use a simple Liquid tag to create the markup. For our
individual team member pages we insert the team member’s photo with:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
{% picture team_individual {{ page.photo }} alt=&quot;{{ page.name }}&quot; %}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We’re using the &lt;code class=&quot;highlighter-rouge&quot;&gt;team_individual&lt;/code&gt; preset, so four versions of the image will be
created (two at each specified width, and two images at double those dimensions
for hi-res displays). The markup ends up like this:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;picture&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-700by710-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(min-width: 400px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 400px) and (min-resolution: 192dpi)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-350by355-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(min-width: 400px)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-576by584-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;media=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;srcset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;image--team-individual&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;image&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;alt=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Anne Tomasevich&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/picture&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With some easy setup, we’re cutting down drastically on the sizes of images
served at smaller screen sizes and lower resolutions!&lt;/p&gt;

&lt;h4 id=&quot;background-images&quot;&gt;Background images&lt;/h4&gt;

&lt;p&gt;One place we couldn’t use this plugin is for images displayed via the CSS
&lt;code class=&quot;highlighter-rouge&quot;&gt;background-image&lt;/code&gt; property, which we’re using for some hero images. For the
large image on the home page, I manually created a variety of images (known in
the responsive image world as &lt;a href=&quot;https://developers.google.com/web/fundamentals/design-and-ui/media/images#art_direction&quot;&gt;art direction&lt;/a&gt;)
then used media queries to display the appropriate image as the background image.
You can check out the &lt;a href=&quot;https://github.com/savaslabs/savaslabs.github.io/blob/e61687f846a2ee605a5141cb9fa8a16c2de28339/_assets/styles/scss/components/_home-cover-image.scss&quot;&gt;SCSS on GitHub&lt;/a&gt;.
Since this is a much more time-consuming process I haven’t implemented this for
all of our background images yet, but taking the time to create images that will
look exactly how we want them at all screen sizes will be well worth it!&lt;/p&gt;

&lt;h3 id=&quot;build-and-serve-tasks&quot;&gt;Build and serve tasks&lt;/h3&gt;

&lt;p&gt;To pull it all together, we have a default task to build the site (creating the
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; directory which holds the compiled HTML, CSS, JS, and images that comprise our site)
and a &lt;code class=&quot;highlighter-rouge&quot;&gt;serve&lt;/code&gt; task to watch our files and rebuild the appropriate files or the
entire site when those files change.&lt;/p&gt;

&lt;p&gt;The default task deletes the site by running the &lt;code class=&quot;highlighter-rouge&quot;&gt;clean&lt;/code&gt; tasks then runs all the
&lt;code class=&quot;highlighter-rouge&quot;&gt;build&lt;/code&gt; tasks, then the &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; command to build the site using our
processed assets.&lt;/p&gt;

&lt;p&gt;A little gulp tip: tasks passed within square brackets are run concurrently (one
of the major advantages of using gulp over Grunt, which can only run one task at
a time), while items in a comma-separated list are run sequentially. We’ll need
this to run the build tasks in the correct order since we need to create our
&lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; directory before running &lt;code class=&quot;highlighter-rouge&quot;&gt;build:jekyll&lt;/code&gt;, which will copy &lt;code class=&quot;highlighter-rouge&quot;&gt;assets&lt;/code&gt; to
&lt;code class=&quot;highlighter-rouge&quot;&gt;_site/assets&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Deletes the entire _site directory.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_site&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Main clean task.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Deletes _site directory and processed assets.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&#39;clean:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Builds site anew.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;runSequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;clean&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;build:fonts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Default Task: builds site.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;default&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp&lt;/code&gt; will run the default task &lt;code class=&quot;highlighter-rouge&quot;&gt;build&lt;/code&gt; and will build the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt;
directory. This is what we want in production, but let’s go back to our three
separate Jekyll configuration files. We want to create gulp tasks using
&lt;code class=&quot;highlighter-rouge&quot;&gt;config.test.yml&lt;/code&gt; for running our test script and &lt;code class=&quot;highlighter-rouge&quot;&gt;config.dev.yml&lt;/code&gt; for local
development.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command using test config.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:test&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml,_config.test.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Runs jekyll build command using local config.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;bundle exec jekyll build --config _config.yml,_config.test.yml,_config.dev.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pipe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shellCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gutil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The last thing we needed is a gulp command to serve the site and watch for file
changes. To accomplish this we’re using &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp.watch()&lt;/code&gt;, which tells gulp to run
a specified task if the targeted files are changed. We also created a couple of
special tasks to tell the browser to reload the served site on changes to Jekyll
files (templates, config, etc.) or Javascript files. We already included
&lt;code class=&quot;highlighter-rouge&quot;&gt;.pipe(browserSync.stream())&lt;/code&gt; in our &lt;code class=&quot;highlighter-rouge&quot;&gt;build:styles:main&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;build:images&lt;/code&gt; tasks, so
when these files are updated the changes will be injected into our local site
and we won’t even need a refresh.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Special tasks for building and then reloading BrowserSync.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Static Server + watching files.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Note: passing anything besides hard-coded literal paths with globs doesn&#39;t&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// seem to work with gulp.watch().&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;serve&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:local&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;browserSync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;siteDir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;ghostMode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Toggle to mirror clicks, reloads etc. (performance)&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;logFileChanges&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;logLevel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;debug&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// Toggle to automatically open page when starting.&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch site settings.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_config.yml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch .scss files; changes are piped to browserSync.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/styles/**/*.scss&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:styles&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch .js files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/js/**/*.js&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:scripts:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch image files; changes are piped to browserSync.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_assets/img/**/*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:images&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch posts.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_posts/**/*.+(md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch drafts if --drafts flag was passed.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drafts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_drafts/*.+(md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch html and markdown files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;**/*.+(html|md|markdown|MD)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;!_site/**/*.*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch RSS feed XML file.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;feed.xml&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch data files.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;_data/**.*+(yml|yaml|csv|json)&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Watch favicon.png.&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gulp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;watch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;favicon.png&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;build:jekyll:watch&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this, we can run &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp serve&lt;/code&gt; to fire up our site locally. The initial
build takes a bit longer than &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt; but the convenience of
automatically opening a browser window, automatic refreshing, and new CSS being
injected is fantastic!&lt;/p&gt;

&lt;h2 id=&quot;the-results&quot;&gt;The Results&lt;/h2&gt;

&lt;p&gt;After implementing these changes, our mobile PageSpeed score shot up to 92/100,
with our desktop score at 95/100!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/pagespeed-insights-results.jpg&quot; alt=&quot;95/100 Google PageSpeed Insights score!&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;To pat ourselves on the back a little more, I should mention that we were already
doing great in the user experience department.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/pagespeed-insights-user-experience.jpg&quot; alt=&quot;Passing Google PageSpeed Insights user experience items.&quot; class=&quot;blog-image-full-width&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;That’s grounds for a little celebration in my opinion!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/liz-lemon-self-five.gif&quot; class=&quot;blog-image&quot; style=&quot;max-width: 300px;&quot; alt=&quot;Tina Fey as Liz Lemon giving herself an awesome high five.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In addition to improving performance on our existing site, we now have a
framework in place to ensure good performance in the future — using gulp to
build the site for production will automatically optimize our CSS, JS, and image
assets. Plus, our local development workflow is more streamlined both because
we took the time to think through our asset pipeline and because we can
capitalize on tools like Browsersync to enhance the development experience.&lt;/p&gt;

&lt;h2 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h2&gt;

&lt;p&gt;There are a couple things I’d like to improve with this process:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Once an image is optimized via imagemin it shouldn’t be processed each time
&lt;code class=&quot;highlighter-rouge&quot;&gt;build:images&lt;/code&gt; runs. By doing this, we’ll save time both when building the site
for testing and deployment and for spinning up the site locally.&lt;/li&gt;
  &lt;li&gt;Similarly, once an image is processed by Jekyll Picture Tag it doesn’t need to
be re-processed on every run of &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;further-resources&quot;&gt;Further Resources&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://aaronlasseigne.com/2016/02/03/using-gulp-with-jekyll/&quot;&gt;Aaron Lasseigne’s take on gulp + Jekyll&lt;/a&gt;,
which breaks down the gulp tasks nicely&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.smashingmagazine.com/2014/06/building-with-gulp/&quot;&gt;Smashing Magazine’s deep dive into gulp&lt;/a&gt;,
a must-read for gulp beginners!&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.smashingmagazine.com/2014/05/responsive-images-done-right-guide-picture-srcset/&quot;&gt;Smashing Magazine’s guide to the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;picture&amp;gt;&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
",
      "url": "https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html"
    }
  </script>

  

  <!-- Google Analytics. -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61514316-1', 'auto');
  ga('send', 'pageview');

</script>



  <!-- Load main CSS file asynchronously via loadCSS. -->
  <script>
    !function(e){"use strict";var t=function(t,n,r){function o(e){return i.body?e():void setTimeout(function(){o(e)})}function l(){d.addEventListener&&d.removeEventListener("load",l),d.media=r||"all"}var a,i=e.document,d=i.createElement("link");if(n)a=n;else{var s=(i.body||i.getElementsByTagName("head")[0]).childNodes;a=s[s.length-1]}var u=i.styleSheets;d.rel="stylesheet",d.href=t,d.media="only x",o(function(){a.parentNode.insertBefore(d,n?a:a.nextSibling)});var f=function(e){for(var t=d.href,n=u.length;n--;)if(u[n].href===t)return e();setTimeout(function(){f(e)})};return d.addEventListener&&d.addEventListener("load",l),d.onloadcssdefined=f,f(l),d};"undefined"!=typeof exports?exports.loadCSS=t:e.loadCSS=t}("undefined"!=typeof global?global:this),function(e){if(e.loadCSS){var t=loadCSS.relpreload={};if(t.support=function(){try{return e.document.createElement("link").relList.supports("preload")}catch(t){}},t.poly=function(){for(var t=e.document.getElementsByTagName("link"),n=0;n<t.length;n++){var r=t[n];"preload"===r.rel&&"style"===r.getAttribute("as")&&(e.loadCSS(r.href,r),r.rel=null)}},!t.support()){t.poly();var n=e.setInterval(t.poly,300);e.addEventListener&&e.addEventListener("load",function(){e.clearInterval(n)})}}}(this);
    loadCSS('/assets/styles/main.css');
    loadCSS('https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700|Roboto+Slab:300,400|Roboto:400,400i,700,700i');
  </script>

  <!-- Inline critical CSS. -->
  <style>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:0.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}.bg-magenta{background-color:#9e023b}.bg-orange{background-color:#d3281b}.bg-eggshell{background-color:#fff8f3}.bg-teal{background-color:#0a5365}.bg-dark-teal{background-color:#06282d}.bg-grey{background-color:#565d5e}.bg-light-grey{background-color:#bdc2c3}.bg-light-teal{background-color:#f3f6f7}.bg-light-orange{background-color:#f29c96}.bg-purple{background-color:#501888}.bg-pink{background-color:#d33682}.bg-yellow{background-color:#f2a324}.bg-green{background-color:#055c2b}.c-magenta{color:#9e023b}.c-orange{color:#d3281b}.c-eggshell{color:#fff8f3}.c-teal{color:#0a5365}.c-dark-teal{color:#06282d}.c-grey{color:#565d5e}.c-light-grey{color:#bdc2c3}.c-light-teal{color:#f3f6f7}.c-light-orange{color:#f29c96}.c-purple{color:#501888}.c-pink{color:#d33682}.c-yellow{color:#f2a324}.c-green{color:#055c2b}button,[type='button'],[type='reset'],[type='submit']{appearance:none;background-color:#0a5365;border:0;border-radius:3px;color:#fff;cursor:pointer;display:inline-block;font-family:-apple-system,BlinkMacSystemFont,"Avenir Next","Avenir","Segoe UI","Lucida Grande","Helvetica Neue","Helvetica","Fira Sans","Roboto","Noto","Droid Sans","Cantarell","Oxygen","Ubuntu","Franklin Gothic Medium","Century Gothic","Liberation Sans",sans-serif;font-size:1em;-webkit-font-smoothing:antialiased;font-weight:600;line-height:1;padding:.75em 1em;text-align:center;text-decoration:none;transition:background-color 150ms ease;user-select:none;vertical-align:middle;white-space:nowrap}button:hover,button:focus,[type='button']:hover,[type='button']:focus,[type='reset']:hover,[type='reset']:focus,[type='submit']:hover,[type='submit']:focus{background-color:#084251;color:#fff}button:disabled,[type='button']:disabled,[type='reset']:disabled,[type='submit']:disabled{cursor:not-allowed;opacity:0.5}button:disabled:hover,[type='button']:disabled:hover,[type='reset']:disabled:hover,[type='submit']:disabled:hover{background-color:#0a5365}fieldset{background-color:transparent;border:0;margin:0;padding:0}legend{font-weight:600;margin-bottom:.375em;padding:0}label{display:block;font-weight:600;margin-bottom:.375em}input,select,textarea{display:block;font-family:-apple-system,BlinkMacSystemFont,"Avenir Next","Avenir","Segoe UI","Lucida Grande","Helvetica Neue","Helvetica","Fira Sans","Roboto","Noto","Droid Sans","Cantarell","Oxygen","Ubuntu","Franklin Gothic Medium","Century Gothic","Liberation Sans",sans-serif;font-size:1em}[type='color'],[type='date'],[type='datetime'],[type='datetime-local'],[type='email'],[type='month'],[type='number'],[type='password'],[type='search'],[type='tel'],[type='text'],[type='time'],[type='url'],[type='week'],input:not([type]),textarea{appearance:none;background-color:#fff;border:1px solid #ddd;border-radius:3px;box-shadow:inset 0 1px 3px rgba(0,0,0,0.06);box-sizing:border-box;margin-bottom:.75em;padding:.3333333333em;transition:border-color 150ms ease;width:100%}[type='color']:hover,[type='date']:hover,[type='datetime']:hover,[type='datetime-local']:hover,[type='email']:hover,[type='month']:hover,[type='number']:hover,[type='password']:hover,[type='search']:hover,[type='tel']:hover,[type='text']:hover,[type='time']:hover,[type='url']:hover,[type='week']:hover,input:not([type]):hover,textarea:hover{border-color:#b1b1b1}[type='color']:focus,[type='date']:focus,[type='datetime']:focus,[type='datetime-local']:focus,[type='email']:focus,[type='month']:focus,[type='number']:focus,[type='password']:focus,[type='search']:focus,[type='tel']:focus,[type='text']:focus,[type='time']:focus,[type='url']:focus,[type='week']:focus,input:not([type]):focus,textarea:focus{border-color:#0a5365;box-shadow:inset 0 1px 3px rgba(0,0,0,0.06),0 0 5px rgba(18,89,169,0.7);outline:none}[type='color']:disabled,[type='date']:disabled,[type='datetime']:disabled,[type='datetime-local']:disabled,[type='email']:disabled,[type='month']:disabled,[type='number']:disabled,[type='password']:disabled,[type='search']:disabled,[type='tel']:disabled,[type='text']:disabled,[type='time']:disabled,[type='url']:disabled,[type='week']:disabled,input:not([type]):disabled,textarea:disabled{background-color:#f2f2f2;cursor:not-allowed}[type='color']:disabled:hover,[type='date']:disabled:hover,[type='datetime']:disabled:hover,[type='datetime-local']:disabled:hover,[type='email']:disabled:hover,[type='month']:disabled:hover,[type='number']:disabled:hover,[type='password']:disabled:hover,[type='search']:disabled:hover,[type='tel']:disabled:hover,[type='text']:disabled:hover,[type='time']:disabled:hover,[type='url']:disabled:hover,[type='week']:disabled:hover,input:not([type]):disabled:hover,textarea:disabled:hover{border:1px solid #ddd}[type='color']::placeholder,[type='date']::placeholder,[type='datetime']::placeholder,[type='datetime-local']::placeholder,[type='email']::placeholder,[type='month']::placeholder,[type='number']::placeholder,[type='password']::placeholder,[type='search']::placeholder,[type='tel']::placeholder,[type='text']::placeholder,[type='time']::placeholder,[type='url']::placeholder,[type='week']::placeholder,input:not([type])::placeholder,textarea::placeholder{color:#858585}textarea{resize:vertical}[type="checkbox"],[type="radio"]{display:inline;margin-right:.375em}[type="file"]{margin-bottom:.75em;width:100%}select{margin-bottom:.75em;width:100%}html{box-sizing:border-box}*,*::before,*::after{box-sizing:inherit}html,body{height:100%}ul,ol{list-style-type:none;margin:0;padding:0}dl{margin:0}dt{font-weight:600;margin:0}dd{margin:0}figure{margin:0}img,picture{margin:0;max-width:100%}table{border-collapse:collapse;margin:.75em 0;table-layout:fixed;width:100%}th{border-bottom:1px solid #a6a6a6;font-weight:600;padding:.75em 0;text-align:left}td{border-bottom:1px solid #ddd;padding:.75em 0}tr,td,th{vertical-align:middle}body{color:#333;font-family:-apple-system,BlinkMacSystemFont,"Avenir Next","Avenir","Segoe UI","Lucida Grande","Helvetica Neue","Helvetica","Fira Sans","Roboto","Noto","Droid Sans","Cantarell","Oxygen","Ubuntu","Franklin Gothic Medium","Century Gothic","Liberation Sans",sans-serif;font-size:1em;line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,"Avenir Next","Avenir","Segoe UI","Lucida Grande","Helvetica Neue","Helvetica","Fira Sans","Roboto","Noto","Droid Sans","Cantarell","Oxygen","Ubuntu","Franklin Gothic Medium","Century Gothic","Liberation Sans",sans-serif;font-size:1.25em;line-height:1.2;margin:0 0 .75em}p{margin:0 0 .75em}a{color:#0a5365;text-decoration:none;transition:color 150ms ease}a:active,a:focus,a:hover{color:#083e4c}hr{border-bottom:1px solid #ddd;border-left:0;border-right:0;border-top:0;margin:1em 0}.nowrap{white-space:nowrap}.region{max-width:1440px;margin-left:auto;margin-right:auto;clear:both;max-width:1400px;padding:1.5em 1em;vertical-align:baseline}.region::after{clear:both;content:"";display:block}@media only screen and (min-width: 640px){.region{padding:3em 1em}}@media only screen and (min-width: 1440px){.region{padding:3em 0}}.region--full-width{clear:both;margin:1.5em 0}@media only screen and (min-width: 640px){.region--full-width{margin:3em 0}}.region--full-width .region--full-width__wrapper{max-width:1440px;margin-left:auto;margin-right:auto;margin:0 auto;max-width:1400px;vertical-align:baseline}.region--full-width .region--full-width__wrapper::after{clear:both;content:"";display:block}.outer-container{max-width:1440px;margin-left:auto;margin-right:auto;width:100%}.outer-container::after{clear:both;content:"";display:block}.flex-center{align-items:center;display:flex;justify-content:center}.hide-for-small{display:none}@media only screen and (min-width: 450px){.hide-for-small{display:block}}.hide-for-medium{display:block}@media only screen and (min-width: 640px){.hide-for-medium{display:none}}@media only screen and (min-width: 860px){.hide-for-medium{display:block}}.hide-for-large{display:block}@media only screen and (min-width: 860px){.hide-for-large{display:none}}.sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.m0{margin:0}.breadcrumbs{font-size:1em;margin-top:-1.5em}.breadcrumbs i{margin-left:.5em}h1,h2,h3,h4,h5,h6{color:#0a5365;font-family:"Roboto Slab",Verdana,sans-serif;font-weight:300}h1,.h1{font-size:2.074em}@media only screen and (min-width: 640px){h1,.h1{font-size:2.441em}}h2,.h2{font-size:1.728em}@media only screen and (min-width: 640px){h2,.h2{font-size:1.953em}}h3,.h3{font-size:1.44em}@media only screen and (min-width: 640px){h3,.h3{font-size:1.563em}}h4,.h4{font-size:1.2em}@media only screen and (min-width: 640px){h4,.h4{font-size:1.25em}}h5,.h5{font-size:1.1em}h6,.h6{font-size:1em}.heading--bold{font-weight:700}.heading--sans-serif{font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif}article h2,article h3,article h4,article h5,article h6{color:#9e023b;font-weight:400;margin-top:1.5em}article h2::after{background:#0a5365;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.page--post__main h1{color:#9e023b}.heading--underline::after{background:#0a5365;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.heading--underline--orange::after{background:#d3281b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.heading--underline--magenta::after{background:#9e023b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.heading--underline--eggshell::after{background:#fff8f3;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.heading--underline--right{position:relative;text-align:right}.heading--underline--right::after{background:#0a5365;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px;position:absolute;right:0}.heading--underline--right--orange{position:relative;text-align:right}.heading--underline--right--orange::after{background:#d3281b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px;position:absolute;right:0}.heading--underline--right--magenta{position:relative;text-align:right}.heading--underline--right--magenta::after{background:#9e023b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px;position:absolute;right:0}.heading--underline--right--eggshell{position:relative;text-align:right}.heading--underline--right--eggshell::after{background:#fff8f3;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px;position:absolute;right:0}a{color:#0a5365;transition:all .1s linear}a:hover,a:focus{color:#0f7993}.link--light{color:#fff8f3}.link--light:hover,.link--light:focus{color:#d3281b}.link--light--no-hover{color:#fff8f3}.link--light--no-hover:hover,.link--light--no-hover:focus{color:#fff8f3}.link--arrow{text-transform:uppercase}.link--arrow::after{content:'\f105';font-family:FontAwesome;font-size:1.25em;margin-left:.75em}p a,article ul a,article ol a,.link--inline{border-bottom:0.1em solid rgba(211,40,27,0.1);color:#d3281b}p a:hover,p a:focus,article ul a:hover,article ul a:focus,article ol a:hover,article ol a:focus,.link--inline:hover,.link--inline:focus{border-bottom:0.1em solid #9e023b;color:#9e023b}ul{list-style-type:square}ol{list-style-type:decimal}ul,ol{margin-bottom:1em;margin-left:2em}ul ul,ul ol,ol ul,ol ol{margin-bottom:0}ul ul,ul ul li,ul ol,ul ol li,ol ul,ol ul li,ol ol,ol ol li,ul p,ol p{font-size:1em !important}article ol,article ul{font-family:"Roboto",Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.125em;line-height:1.625}article li{margin-bottom:.325em}article li li{margin-top:.325em}.list--bordered{display:flex;flex-wrap:wrap}@media only screen and (min-width: 640px){.list--bordered{flex-wrap:nowrap}}.list--bordered ul{border-left:solid 2px #f29c96;flex-basis:100%;margin:0;padding-left:1em}@media only screen and (min-width: 640px){.list--bordered ul{flex-basis:50%}}.list--bordered ul li{color:#0a5365;font-size:1.25em;padding:.25em 0}.list--bordered ul,.list--bordered li{list-style-type:none}body{color:#565d5e;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif}article{color:#06282d;word-wrap:break-word}article p{font-family:"Roboto",Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.125em;line-height:1.625;margin-bottom:1em}article blockquote p{font-size:1.4em}.paragraph--small{font-size:1em}.paragraph--loud{font-size:1.25em}.paragraph--louder{font-size:1.563em}.paragraph--loud--responsive{font-size:1.25em}@media only screen and (min-width: 860px){.paragraph--loud--responsive{font-size:1.563em}}.button--arrow{background-color:transparent;border:solid 2px #0a5365;border-radius:0;color:#0a5365;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #0a5365;border-radius:0;color:#0a5365;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow:hover,.button--arrow:focus{background-color:#0f7993;border-color:#0f7993;color:#fff}@media only screen and (min-width: 640px){.button--arrow{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow::after{background-color:#0a5365;color:#fff;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow:hover::after,.button--arrow:focus::after{background-color:#0f7993;color:#fff}.button--arrow--magenta{background-color:transparent;border:solid 2px #9e023b;border-radius:0;color:#9e023b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #9e023b;border-radius:0;color:#9e023b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow--magenta:hover,.button--arrow--magenta:focus{background-color:#d0034e;border-color:#d0034e;color:#fff}@media only screen and (min-width: 640px){.button--arrow--magenta{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow--magenta::after{background-color:#9e023b;color:#fff;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow--magenta:hover::after,.button--arrow--magenta:focus::after{background-color:#d0034e;color:#fff}.button--arrow--orange{background-color:transparent;border:solid 2px #d3281b;border-radius:0;color:#d3281b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #d3281b;border-radius:0;color:#d3281b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow--orange:hover,.button--arrow--orange:focus{background-color:#e6473b;border-color:#e6473b;color:#fff}@media only screen and (min-width: 640px){.button--arrow--orange{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow--orange::after{background-color:#d3281b;color:#fff;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow--orange:hover::after,.button--arrow--orange:focus::after{background-color:#e6473b;color:#fff}.button--arrow--white-teal{background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow--white-teal:hover,.button--arrow--white-teal:focus{background-color:#fff;border-color:#fff;color:#0f7993}@media only screen and (min-width: 640px){.button--arrow--white-teal{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow--white-teal::after{background-color:#fff;color:#0a5365;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow--white-teal:hover::after,.button--arrow--white-teal:focus::after{background-color:#fff;color:#0f7993}.button--arrow--white-magenta{background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow--white-magenta:hover,.button--arrow--white-magenta:focus{background-color:#fff;border-color:#fff;color:#d0034e}@media only screen and (min-width: 640px){.button--arrow--white-magenta{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow--white-magenta::after{background-color:#fff;color:#9e023b;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow--white-magenta:hover::after,.button--arrow--white-magenta:focus::after{background-color:#fff;color:#d0034e}.button--arrow--white-orange{background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #fff;border-radius:0;color:#fff;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.button--arrow--white-orange:hover,.button--arrow--white-orange:focus{background-color:#fff;border-color:#fff;color:#e6473b}@media only screen and (min-width: 640px){.button--arrow--white-orange{font-size:1.25em;padding:0 90px 0 30px}}.button--arrow--white-orange::after{background-color:#fff;color:#d3281b;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.button--arrow--white-orange:hover::after,.button--arrow--white-orange:focus::after{background-color:#fff;color:#e6473b}[type="submit"]{background-color:transparent;border:solid 2px #fff8f3;border-radius:0;color:#fff8f3;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:#0a5365;border-color:#0a5365;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;padding:1em 3em;text-transform:none}[type="submit"]:hover,[type="submit"]:focus{background-color:#fff;border-color:#fff;color:#0f7993}[type="submit"]:hover,[type="submit"]:focus{background-color:#0f7993;border-color:#0f7993;color:#fff}.case-study-block h3{transition:all .2s ease-in-out;margin-bottom:0}.case-study-block .case-study-block__image{transition:all .2s ease-in-out;background-position:center;background-repeat:no-repeat;background-size:70%;margin-bottom:.75em}@media only screen and (min-width: 640px){.case-study-block .case-study-block__image{background-size:50%}}@media only screen and (min-width: 860px){.case-study-block .case-study-block__image{background-size:70%}}@media only screen and (min-width: 1120px){.case-study-block .case-study-block__image{background-size:50%}}.case-study-block .case-study-block__image img{transition:all .2s ease-in-out;display:block}.case-study-block .case-study-block__tags p{font-size:1.25em;color:#565d5e;display:inline;text-transform:capitalize}.case-study-block .case-study-block__link:hover h3,.case-study-block .case-study-block__link:focus h3{color:#d3281b}.case-study-block .case-study-block__link:hover .case-study-block__image,.case-study-block .case-study-block__link:focus .case-study-block__image{background-color:#d3281b}.case-study-block .case-study-block__link:hover .case-study-block__image img,.case-study-block .case-study-block__link:focus .case-study-block__image img{opacity:.15}.case-study-block .case-study-block__link:hover .case-study-block__tags p,.case-study-block .case-study-block__link:focus .case-study-block__tags p{color:#06282d}.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-angle-double-down:before{content:""}.fa-angle-right:before{content:""}.fa-building-o:before{content:""}.fa-circle:before{content:""}.fa-comment:before{content:""}.fa-comment-o:before{content:""}.fa-drupal:before{content:""}.fa-envelope-o:before{content:""}.fa-file-text:before{content:""}.fa-github:before{content:""}.fa-globe:before{content:""}.fa-linkedin:before{content:""}.fa-long-arrow-right:before{content:""}.fa-phone:before{content:""}.fa-stack-exchange:before{content:""}.fa-tags:before{content:""}.fa-twitter:before{content:""}label{font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:bold}[type='color'],[type='date'],[type='datetime'],[type='datetime-local'],[type='email'],[type='month'],[type='number'],[type='password'],[type='search'],[type='tel'],[type='text'],[type='time'],[type='url'],[type='week'],input:not([type]),textarea{border-radius:0;color:#565d5e;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;padding:1.25em .75em}[type='color']:focus,[type='date']:focus,[type='datetime']:focus,[type='datetime-local']:focus,[type='email']:focus,[type='month']:focus,[type='number']:focus,[type='password']:focus,[type='search']:focus,[type='tel']:focus,[type='text']:focus,[type='time']:focus,[type='url']:focus,[type='week']:focus,input:not([type]):focus,textarea:focus{border-color:#b1b1b1;box-shadow:none}.header-navigation{float:none;z-index:9999999}@media only screen and (min-width: 640px){.header-navigation{clear:none;float:right;padding-bottom:0;padding-right:.75em}}.header-navigation__menu{clear:both;display:none;margin:0 auto;overflow:visible;padding:0;-webkit-transform-style:preserve-3d;width:100%;z-index:9999}@media only screen and (min-width: 640px){.header-navigation__menu{display:inline;margin:0;padding:0}}.header-navigation__menu.show{display:block}.header-navigation__mobile-menu-link{color:#06282d;display:block;float:right;font-weight:700;line-height:5.25em;margin:0;padding-right:1em;text-transform:uppercase}@media only screen and (min-width: 640px){.header-navigation__mobile-menu-link{display:none}}.header-navigation__mobile-menu-link:focus,.header-navigation__mobile-menu-link:hover{color:#9e023b}.header-navigation__menu-link{display:block;line-height:2.625em;overflow:hidden;padding-right:.8em;text-align:right;width:100%;z-index:9999}@media only screen and (min-width: 640px){.header-navigation__menu-link{display:inline;line-height:5.25em;margin-right:-5px;padding-right:0;width:auto}.header-navigation__menu-link:last-child{margin-right:0}}.header-navigation__menu-link:last-child:not(.header-navigation__active-nav-item):not(:hover):not(:focus) a{color:#9e023b}.header-navigation__menu-link:last-child a{font-weight:bold}.header-navigation__menu-link a{color:#06282d;display:inline-block;font-weight:400;text-transform:uppercase;transition:background-color ease .2s}.header-navigation__menu-link a:focus,.header-navigation__menu-link a:hover{color:#9e023b}@media only screen and (min-width: 640px){.header-navigation__menu-link a{padding-left:.75em;padding-right:.75em}.header-navigation__menu-link a:focus,.header-navigation__menu-link a:hover{background-color:rgba(158,2,59,0.9);color:#fff}}.header-navigation__active-nav-item{background-color:rgba(158,2,59,0.9)}@media only screen and (min-width: 640px){.header-navigation__active-nav-item{background-color:rgba(255,255,255,0.9);color:#06282d}}.header-navigation__active-nav-item a{color:#fff}@media only screen and (min-width: 640px){.header-navigation__active-nav-item a{background-color:rgba(158,2,59,0.9)}}.icon--job{align-items:center;background-color:#f3f6f7;border-radius:50%;display:flex;height:230px;justify-content:center;margin:2em auto 0;padding:1em;width:230px}.icon--job img{max-width:150px}.icon--service .icon--service__link{padding:0 .25em;width:100%}.icon--service .icon--service__image{transition:all .2s ease-in-out;border-radius:50%;height:4em;margin:0 auto;margin-bottom:.5em;padding:.75em;width:4em}.icon--service .icon--service__image img{transition:all .2s ease-in-out;display:block}.icon--service .icon--service__title{transition:all .2s ease-in-out;font-size:1.1em;max-width:100%;text-align:center}@media only screen and (min-width: 860px){.icon--service .icon--service__title{font-size:1.25em}}.icon--service--bold .icon--service__link:hover .icon--service__image,.icon--service--bold .icon--service__link:focus .icon--service__image{background-color:#d3281b}.icon--service--bold .icon--service__link:hover .icon--service__image img,.icon--service--bold .icon--service__link:focus .icon--service__image img{filter:brightness(0) invert(1)}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active){.icon--service--bold .icon--service__link:hover .icon--service__image,.icon--service--bold .icon--service__link:focus .icon--service__image{background:transparent}.icon--service--bold .icon--service__link:hover .icon--service__image img,.icon--service--bold .icon--service__link:focus .icon--service__image img{-moz-transform:scale(1.3);-webkit-transform:scale(1.3);transform:scale(1.3)}}.icon--service--bold .icon--service__link:hover .icon--service__title,.icon--service--bold .icon--service__link:focus .icon--service__title{color:#d3281b}.icon--service--subtle .icon--service__link{transition:all .2s ease-in-out;border-bottom:solid 3px transparent}.icon--service--subtle .icon--service__link:hover,.icon--service--subtle .icon--service__link:focus{border-color:#d3281b}.icon--service--subtle .icon--service__image{margin-bottom:0}.icon--service--subtle .icon--service__title{font-size:1em}.region--hero--company{background:url("/assets/img/bg/blue-bg-glow.jpg") #06282d center center no-repeat;background-size:cover;display:flex;justify-content:flex-start;margin:0;position:relative;width:100%}@media only screen and (min-width: 640px){.region--hero--company{height:calc(90vh - 84px);min-height:660px}}.region--hero--company.region--full-width{margin:0}.region--hero--company .region--hero--company__wrapper{display:block;left:0;margin:auto;padding:0;right:0;width:100%}@media only screen and (min-width: 640px){.region--hero--company .region--hero--company__wrapper{bottom:0;padding:0 1em;position:absolute}}@media only screen and (min-width: 1440px){.region--hero--company .region--hero--company__wrapper{padding:0}}.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width{align-items:center;display:flex;flex-direction:column;padding:2em}.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width h1,.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width a{color:#fff8f3}.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width h1{font-family:"Roboto Slab",Verdana,sans-serif;text-align:center;text-shadow:#06282d 2px 2px 2px}.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width a::after{transition:all .2s ease-in-out}.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width a:hover::after,.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width a:focus::after,.region--hero--company .region--hero--company__wrapper .region--hero--company__heading-full-width a:active::after{color:#d3281b}@media only screen and (min-width: 640px){.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col{align-items:center;display:flex}}.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text,.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__image{display:block;position:relative;width:100%}@media only screen and (min-width: 640px){.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text,.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__image{flex-basis:50%;height:50vh;min-height:440px}}.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text{background:#06282d;color:#fff8f3;display:flex;flex-direction:column;justify-content:center;padding:2em 1.5em}@media only screen and (min-width: 1120px){.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text{padding:2em 3em}}.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text h2{color:#fff8f3;font-size:1.25em}@media only screen and (min-width: 640px){.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text h2{font-size:1.75em}}@media only screen and (min-width: 640px){.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__text p{font-size:1.25em}}.region--hero--company .region--hero--company__wrapper .region--hero--company__two-col .region--hero--company__two-col__image{background:url("/assets/img/bg/company-hero.jpg") #06282d 10% center no-repeat;background-size:cover}.home__cover{align-items:center;background:url("/assets/img/bg/home-cover.jpg") #fff 50% center no-repeat;background-size:cover;display:flex;flex-direction:column;height:auto;justify-content:flex-start;position:relative;text-align:center;width:100%}@media only screen and (min-width: 640px){.home__cover{height:80vh;min-height:580px}}@media only screen and (min-width: 860px){.home__cover{height:75vh}}@media only screen and (min-width: 1120px){.home__cover{height:100vh;min-height:600px}}.home__cover .home__cover__heading,.home__cover .home__cover__cta{display:flex;flex-basis:100%;justify-content:center;margin:0 auto;max-width:100%;position:relative}.home__cover .home__cover__heading{clear:both;color:#06282d;display:block;font-size:1.5em;font-weight:400;margin-top:100px;max-width:400px;padding:1em 1em 3em;width:100%}@media only screen and (min-width: 640px){.home__cover .home__cover__heading{font-size:3em;max-width:780px;padding:1em}}@media only screen and (min-width: 1120px){.home__cover .home__cover__heading{font-size:4em}}@media only screen and (min-width: 1440px){.home__cover .home__cover__heading{font-size:4.75em;max-width:800px}}.home__cover .home__cover__heading span{font-size:1.3em}.home__cover .home__cover__cta{margin-top:2em;padding-bottom:3em}@media only screen and (min-width: 640px){.home__cover .home__cover__cta{bottom:24%;left:0;margin-top:4em;position:absolute;text-align:center;width:100%}}.home__cover .home__cover__cta a{background-color:rgba(255,248,243,0.2);font-size:1em}@media only screen and (min-width: 640px){.home__cover .home__cover__cta a{font-size:1.25em}}.home__cover .home__cover__cta a:hover,.home__cover .home__cover__cta a:focus,.home__cover .home__cover__cta a:active{background-color:#0f7993}.home__cover .home__cover__content{display:block;margin-top:3em;position:relative;width:100%}@media only screen and (min-width: 640px){.home__cover .home__cover__content{bottom:0;display:flex;height:20%;justify-content:flex-start;left:0;margin-top:0;position:absolute}}.home__cover .home__cover__content h2,.home__cover .home__cover__content h3{color:#fff8f3;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:normal;margin:0;padding:0}.home__cover .home__cover__content .home__cover__content__col-left,.home__cover .home__cover__content .home__cover__content__col-right{background-color:rgba(6,40,45,0.8);bottom:0;padding:0;text-align:center}.home__cover .home__cover__content .home__cover__content__col-left{background-color:#9e023b;background-image:url("assets/img/hp-arrow.svg");background-position:right center;background-repeat:no-repeat;background-size:cover;display:block;position:relative;width:100%;z-index:2}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-left{background-color:rgba(6,40,45,0.8);display:flex;flex-basis:40%;justify-content:flex-end}}.home__cover .home__cover__content .home__cover__content__col-left .home__cover__content__col-left__text{display:block;padding:.5em 1em;position:relative}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-left .home__cover__content__col-left__text{align-items:center;display:flex;max-width:446px;padding:0 4em 0 1em;position:relative;z-index:1}}.home__cover .home__cover__content .home__cover__content__col-left .home__cover__content__col-left__text h2{font-size:.85em;text-align:center}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-left .home__cover__content__col-left__text h2{font-size:1em;max-width:240px}}@media only screen and (min-width: 1120px){.home__cover .home__cover__content .home__cover__content__col-left .home__cover__content__col-left__text h2{font-size:1.25em}}.home__cover .home__cover__content .home__cover__content__col-right{display:block;position:relative;width:100%;z-index:1}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-right{display:flex;flex-basis:60%;justify-content:flex-start}}.home__cover .home__cover__content .home__cover__content__col-right .home__cover__content__col-right__text{display:block;padding:.5em 1em;width:100%}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-right .home__cover__content__col-right__text{align-items:center;display:flex;justify-content:flex-start;max-width:890px;padding:0 2em}}.home__cover .home__cover__content .home__cover__content__col-right .home__cover__content__col-right__text h3{font-size:1em;font-weight:300;text-align:center;text-transform:uppercase}@media only screen and (min-width: 640px){.home__cover .home__cover__content .home__cover__content__col-right .home__cover__content__col-right__text h3{font-size:1.5em;text-align:left;text-transform:none}}@media only screen and (min-width: 1120px){.home__cover .home__cover__content .home__cover__content__col-right .home__cover__content__col-right__text h3{font-size:1.75em}}.region--hero--careers{background-color:#06282d;background-image:url("/assets/img/bg/careers-hero.jpg");background-position:center center;background-size:cover;height:60vh;margin:0}@media only screen and (min-width: 860px){.region--hero--careers{height:70vh}}.region--hero--careers.position{background-image:url("/assets/img/bg/careers-hero-mktn-dir.jpg");height:30vh}.region--hero--mission-values{background-color:#06282d;background-image:url("/assets/img/bg/mission-values-hero.jpg");background-position:center center;background-size:cover;margin:0}.region--hero--mission-values .region--hero__text{color:#fff8f3}.region--hero--mission-values .region--hero__text h1{color:#fff8f3;text-shadow:#06282d 2px 2px 2px}@media only screen and (min-width: 640px){.region--hero--mission-values .region--hero__text p{font-size:1.25em}}.region--hero--open-source{background-color:#fff;background-image:url("/assets/img/bg/os-bg.png");background-repeat:repeat-x;background-size:contain}.region--hero--open-source .region--hero__wrapper{padding:2em 1em}@media only screen and (min-width: 640px){.region--hero--open-source .region--hero__wrapper{padding:0}}.region--hero--open-source .region--hero__image img{max-width:90%}.region--hero--open-source .region--hero__text h1{color:#d3281b;font-size:2.074em;margin-bottom:0}@media only screen and (min-width: 860px){.region--hero--open-source .region--hero__text h1{font-size:2.441em}}.region--hero--open-source .region--hero__badges{align-items:flex-end}.region--hero--open-source .region--hero__badges img{height:auto;margin-bottom:2em;max-width:80%;width:140px}.region--hero--three-col.region--hero--open-source .region--hero__image{flex-basis:70%;order:2}@media only screen and (min-width: 640px){.region--hero--three-col.region--hero--open-source .region--hero__image{flex-basis:40%}}.region--hero--three-col.region--hero--open-source .region--hero__text{order:1;width:100%}@media only screen and (min-width: 640px){.region--hero--three-col.region--hero--open-source .region--hero__text{flex-basis:40%;order:2}}@media only screen and (min-width: 1120px){.region--hero--three-col.region--hero--open-source .region--hero__text{padding-left:2em}}.region--hero--three-col.region--hero--open-source .region--hero__badges{display:flex;flex-basis:30%;flex-direction:column;justify-content:center;order:3}@media only screen and (min-width: 640px){.region--hero--three-col.region--hero--open-source .region--hero__badges{display:flex;flex-basis:20%;order:3}}@media only screen and (min-width: 1120px){.region--hero--three-col.region--hero--open-source .region--hero__badges{flex-basis:20%}}.region--hero--results{background-color:#06282d;color:#fff8f3}.region--hero--results .region--hero__text h1{color:#fff8f3}.region--hero--results .region--hero__image{background-image:url("/assets/img/bg/results-hero.jpg")}.region--hero--services{background-color:#9e023b;margin:0}.region--hero--services .region--hero__text{color:#fff8f3;display:flex;flex-direction:column;justify-content:center}.region--hero--services .region--hero__text h1{color:#fff8f3}.region--hero--services .region--hero__text a,.region--hero--services .region--hero__text a:hover,.region--hero--services .region--hero__text a:focus{color:#fff8f3 !important}@media only screen and (min-width: 640px){.region--hero--services .region--hero__text p{font-size:1.25em}}.region--hero--services .region--hero__image{background-image:url("/assets/img/bg/services-hero.jpg");background-position:10% center}.region--hero--services .region--hero__image.durham{background-image:url("/assets/img/bg/durham-deck.jpg")}.region--hero{margin:0 0 2em}.region--hero .region--hero__wrapper{display:flex;flex-wrap:wrap;justify-content:flex-start;width:100%}@media only screen and (min-width: 640px){.region--hero .region--hero__wrapper{flex-wrap:nowrap}}.region--hero h1{width:100%}@media only screen and (min-width: 640px){.region--hero--half-height .region--hero__wrapper{min-height:calc(50vh - 84px)}}.region--hero--full-width .region--hero__text{align-content:center;display:flex;flex-basis:100%;flex-direction:column;flex-grow:0;flex-shrink:0;justify-content:flex-end;margin:0 auto;max-width:600px;min-height:200px;padding:3em 2em;text-align:center}.region--hero--half-width .region--hero__text,.region--hero--half-width .region--hero__image{flex-basis:100%;flex-grow:0;flex-shrink:0;min-height:200px}@media only screen and (min-width: 640px){.region--hero--half-width .region--hero__text,.region--hero--half-width .region--hero__image{display:flex;flex-basis:50%;flex-direction:column;justify-content:center}}.region--hero--half-width .region--hero__text{color:#fff8f3;padding:3em 1em}@media only screen and (min-width: 640px){.region--hero--half-width .region--hero__text{order:1;padding:4em 2em 4em 1em}}.region--hero--half-width .region--hero__text h1{font-size:1.25em}@media only screen and (min-width: 640px){.region--hero--half-width .region--hero__text h1{font-size:1.953em}}.region--hero--half-width .region--hero__image{background-color:#06282d;background-position:center center;background-repeat:no-repeat;background-size:cover;order:1}@media only screen and (min-width: 640px){.region--hero--half-width .region--hero__image{order:2}}.region--hero--two-thirds-width .region--hero__wrapper{flex-wrap:wrap}@media only screen and (min-width: 860px){.region--hero--two-thirds-width .region--hero__wrapper{flex-wrap:nowrap}}.region--hero--two-thirds-width .region--hero__text,.region--hero--two-thirds-width .region--hero__image{flex-basis:100%;flex-grow:0;flex-shrink:0;min-height:200px}@media only screen and (min-width: 860px){.region--hero--two-thirds-width .region--hero__text,.region--hero--two-thirds-width .region--hero__image{display:flex;flex-direction:column;justify-content:center}}.region--hero--two-thirds-width .region--hero__text{margin:3em 0}@media only screen and (min-width: 860px){.region--hero--two-thirds-width .region--hero__text{flex-basis:35%;padding:4em 0}}.region--hero--two-thirds-width .region--hero__text h1{padding:0 20px}.region--hero--two-thirds-width .region--hero__text p,.region--hero--two-thirds-width .region--hero__text a{padding:0 2em 0 20px}@media only screen and (min-width: 860px){.region--hero--two-thirds-width .region--hero__text p{font-size:1.25em}}.region--hero--two-thirds-width .region--hero__text a{font-size:1em}.region--hero--two-thirds-width .region--hero__text a:hover,.region--hero--two-thirds-width .region--hero__text a:focus,.region--hero--two-thirds-width .region--hero__text aactive{color:#d3281b}.region--hero--two-thirds-width .region--hero__image{background-color:#06282d;background-position:center center;background-repeat:no-repeat;background-size:cover}@media only screen and (min-width: 860px){.region--hero--two-thirds-width .region--hero__image{flex-basis:65%}}.region--hero--three-col .region--hero__wrapper{flex-wrap:wrap;justify-content:space-around}@media only screen and (min-width: 860px){.region--hero--three-col .region--hero__wrapper{flex-wrap:nowrap}}.region--hero--three-col .region--hero__col{flex-basis:100%;flex-grow:0;flex-shrink:0;min-height:200px}@media only screen and (min-width: 640px){.region--hero--three-col .region--hero__col{display:flex;flex-basis:33.33%;flex-direction:column;justify-content:center;padding:1em}}.key-value-list__item{align-items:center;display:flex;flex-wrap:wrap;justify-content:center}@media only screen and (min-width: 640px){.key-value-list__item{flex-wrap:nowrap}}.key-value-list__item:first-child{padding-top:0}.key-value-list__item>div{width:100%}@media only screen and (min-width: 640px){.key-value-list__item .key-value-list__item__key{padding:3em 3em 3em 1em;width:35%}}.key-value-list__item .key-value-list__item__key h3::after{background:#d3281b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}@media only screen and (min-width: 640px){.key-value-list__item .key-value-list__item__key h3{position:relative;text-align:right}.key-value-list__item .key-value-list__item__key h3::after{background:#d3281b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px;position:absolute;right:0}}.key-value-list__item .key-value-list__item__value{padding-bottom:2em}@media only screen and (min-width: 640px){.key-value-list__item .key-value-list__item__value{border-left:solid 1px #d3281b;padding:3em 1em 3em 3em;width:65%}}.savas-logo{display:block;height:5.25em;padding:1.5em 0}.savas-logo--main{display:block;height:2.25em;margin:1.5em 0;padding:0;width:5.125em}.table--minimal,article table{border-collapse:separate;border-spacing:0;width:100%}.table--minimal th,article table th{text-align:left}.table--minimal td,article table td{line-height:1.5}.table--minimal thead th,article table thead th{background-color:#fff;border-bottom:0;padding:0.75em 1em}.table--minimal tbody,article table tbody{background-color:#fff}.table--minimal tbody td,article table tbody td{border-bottom:0;border-top:1px solid #ddd;padding:0.75em 1em}.table--minimal tbody td button,article table tbody td button{display:inline-block;font-size:.7em;line-height:1.5;margin-bottom:.3em;margin-right:.5em;outline:none;padding:.3em 1em;width:100%}@media only screen and (min-width: 640px){.table--minimal tbody td button,article table tbody td button{margin-bottom:0;width:auto}}.table--minimal tbody tr:hover>td,.table--minimal tbody tr:hover>th,article table tbody tr:hover>td,article table tbody tr:hover>th{background-color:#fafafa}.table--minimal tbody tr:first-child td,article table tbody tr:first-child td{border-top:2px solid #ddd}.table--minimal tbody tr:first-child td,.table--minimal tbody tr td,article table tbody tr:first-child td,article table tbody tr td{border-color:#565d5e}.table--minimal tbody tr:hover>td,.table--minimal tbody tr:hover>th,.table--minimal tbody tr:focus>td,.table--minimal tbody tr:focus>th,article table tbody tr:hover>td,article table tbody tr:hover>th,article table tbody tr:focus>td,article table tbody tr:focus>th{transition:all .2s ease-in-out;background-color:#f3f6f7;color:#06282d}.table--minimal tbody ul,article table tbody ul{margin:0}.table--minimal tbody ul,.table--minimal tbody li,article table tbody ul,article table tbody li{list-style-type:none}article table{margin-bottom:3em;margin-top:3em}.tile{position:relative}.tile .tile__hover{align-items:center;color:#fff8f3;display:flex;flex-direction:column;justify-content:center;left:0;opacity:0;padding:1em;position:absolute;text-align:center;top:0;transition:all .3s ease;width:100%;z-index:1}.tile .tile__hover p:first-child{margin-bottom:1.5em;max-width:15em}.tile .tile__hover .link--cta{margin-bottom:0;transition:all .2s ease-in-out}.tile:hover .tile__hover,.tile:focus .tile__hover{opacity:1}.tile:hover .tile--blog--detailed__primary-tag,.tile:focus .tile--blog--detailed__primary-tag{margin-left:1em}.tile:hover .tile--blog__post-title .tile--blog--detailed__author-bg,.tile:focus .tile--blog__post-title .tile--blog--detailed__author-bg{bottom:0;right:0}@media only screen and (min-width: 1120px){.tile p{font-size:1.1em}}.tile--title--blog{padding:2em}.tile--blog .tile--blog__content{align-items:center;display:flex;flex-direction:column;justify-content:center;position:relative;z-index:0}.tile--blog .tile--blog__content>div{height:150px}@media only screen and (min-width: 450px){.tile--blog .tile--blog__content>div{height:200px}}@media only screen and (min-width: 640px){.tile--blog .tile--blog__content>div{height:150px}}@media only screen and (min-width: 1120px){.tile--blog .tile--blog__content>div{height:175px}}@media only screen and (min-width: 1440px){.tile--blog .tile--blog__content>div{height:200px}}.tile--blog .tile--blog__content .tile--blog__image{background-position:center center;background-repeat:no-repeat;background-size:cover;width:100%}.tile--blog .tile--blog__content .tile--blog__post-title{align-items:center;color:#06282d;display:flex;padding:1em;width:100%}.tile--blog .tile--blog__content .tile--blog__post-title p::before{background:#9e023b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}.tile--blog .tile--blog__hover{height:300px}@media only screen and (min-width: 450px){.tile--blog .tile--blog__hover{height:400px}}@media only screen and (min-width: 640px){.tile--blog .tile--blog__hover{height:300px}}@media only screen and (min-width: 1120px){.tile--blog .tile--blog__hover{height:350px}}@media only screen and (min-width: 1440px){.tile--blog .tile--blog__hover{height:400px}}.tile--blog--detailed{flex-basis:auto;flex-grow:0}.tile--blog--detailed .tile--blog__image{position:relative}.tile--blog--detailed .tile--blog__image .tile--blog--detailed__primary-tag{background-color:#0a5365;bottom:1em;color:#fff8f3;font-size:.9em;font-style:italic;left:-1em;margin-bottom:0;padding:.25em 1em;position:absolute;text-transform:uppercase;transition:all .3s ease-in-out}.tile--blog--detailed .tile--blog__post-title{position:relative;z-index:99}.tile--blog--detailed .tile--blog__post-title p{padding-right:44px}.tile--blog--detailed .tile--blog__post-title .tile--blog--detailed__author{bottom:0;position:absolute;right:0;z-index:999}.tile--blog--detailed .tile--blog__post-title .tile--blog--detailed__author img{display:block;filter:grayscale(100%);height:60px;width:60px}.tile--blog--detailed .tile--blog__post-title .tile--blog--detailed__author-bg{background-color:rgba(10,83,101,0.2);bottom:-8px;height:60px;position:absolute;right:-8px;transition:all .3s ease-in-out;width:60px}.tile--blog--detailed.tile--blog .tile--blog__hover{margin:1em;width:calc(100% - 2em)}.tile--blog--latest{background-position:center center;background-repeat:no-repeat;background-size:cover}.tile--blog--latest .tile--blog--latest__link{position:relative;display:flex;flex-direction:column;justify-content:flex-end}.tile--blog--latest .tile--blog--latest__link::after{background-color:transparent;bottom:0;content:'';height:5px;left:0;position:absolute;transition:all .5s ease;width:0;z-index:1}.tile--blog--latest .tile--blog--latest__link:hover::after,.tile--blog--latest .tile--blog--latest__link:focus::after{background-color:#d3281b;width:100%}.tile--blog--latest .tile--blog--latest__link:hover .tile--blog--latest__text,.tile--blog--latest .tile--blog--latest__link:focus .tile--blog--latest__text{background-color:rgba(255,248,243,0.9);color:#06282d}.tile--blog--latest .tile--blog--latest__link:hover .tile--blog--latest__text h2,.tile--blog--latest .tile--blog--latest__link:focus .tile--blog--latest__text h2{color:#06282d}.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text{transition:all .2s ease-in-out;background-color:rgba(6,40,45,0.9);color:#fff8f3;padding:1em}@media only screen and (min-width: 860px){.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text{padding:1em 2em}}.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text h2{transition:all .2s ease-in-out;color:#fff8f3}.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text .tile--blog--latest__text__author,.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text .tile--blog--latest__text__date{display:inline;font-style:italic;margin-bottom:0}.tile--blog--latest .tile--blog--latest__link .tile--blog--latest__text .tile--blog--latest__text__date{float:right}.tile--service .tile--service__link{position:relative;background-color:#f3f6f7;display:block}.tile--service .tile--service__link::after{background-color:transparent;bottom:0;content:'';height:5px;left:0;position:absolute;transition:all .5s ease;width:0;z-index:1}.tile--service .tile--service__link:hover,.tile--service .tile--service__link:focus{background-color:#0a5365;color:#fff8f3}.tile--service .tile--service__link:hover::after,.tile--service .tile--service__link:focus::after{background-color:#d3281b;width:100%}.tile--service .tile--service__link:hover .tile--service__image,.tile--service .tile--service__link:focus .tile--service__image{filter:brightness(0) invert(1)}.tile--service .tile--service__link:hover h2,.tile--service .tile--service__link:focus h2{color:#fff8f3}.tile--service .tile--service__content{max-width:668px;padding:1em}@media only screen and (min-width: 450px){.tile--service .tile--service__content{align-items:flex-start;display:flex}}@media only screen and (min-width: 640px){.tile--service .tile--service__content{display:block;padding:2em}}@media only screen and (min-width: 860px){.tile--service .tile--service__content{display:flex;justify-content:flex-start;padding:3em 2em}}.tile--service .tile--service__content h2,.tile--service .tile--service__content p{transition:all .2s ease-in-out}.tile--service .tile--service__content .tile--service__image{transition:all .2s ease-in-out;display:block;float:left;height:60px;margin-right:1em;min-height:60px;min-width:60px;width:60px}@media only screen and (min-width: 450px){.tile--service .tile--service__content .tile--service__image{float:none;margin-right:2em}}@media only screen and (min-width: 640px){.tile--service .tile--service__content .tile--service__image{float:left;margin-right:1em}}@media only screen and (min-width: 860px){.tile--service .tile--service__content .tile--service__image{float:none;margin-right:2em}}.tile--service .tile--service__content .tile--service__title{font-weight:normal;margin-bottom:1em;margin-top:.5em}@media only screen and (min-width: 640px){.tile--service .tile--service__content .tile--service__title{font-size:1.44em}}@media only screen and (min-width: 860px){.tile--service .tile--service__content .tile--service__title{font-size:1.953em}}@media only screen and (min-width: 1120px){.tile--service .tile--service__content .tile--service__summary{font-size:1.25em}}.tile--service .tile--service__content .tile--service__cta{margin-bottom:0}.region--banner--heading{background:url("/assets/img/bg/diamond-texture.svg") #0a5365 repeat;margin:0 0 .75em}.region--banner--heading .region--banner--heading__text{padding:1em}@media only screen and (min-width: 640px){.region--banner--heading .region--banner--heading__text{align-items:center;display:flex;justify-content:space-between;padding:2em 1em}}@media only screen and (min-width: 1440px){.region--banner--heading .region--banner--heading__text{padding:2em 3em 2em 0}}.region--banner--heading .region--banner--heading__text h1,.region--banner--heading .region--banner--heading__text h1::after{margin-bottom:0}.region--banner--heading .region--banner--heading__text p{font-style:italic;margin-bottom:0;margin-top:1em;text-transform:uppercase}@media only screen and (min-width: 640px){.region--banner--heading .region--banner--heading__text p{margin-top:0}}.region--blog-tiles__wrapper{display:flex;flex-wrap:wrap;justify-content:center}@media only screen and (min-width: 860px){.region--blog-tiles__wrapper{flex-wrap:nowrap}}.region--blog-tiles__wrapper>div{border-bottom:6px solid #fff;display:flex;flex-basis:100%}@media only screen and (min-width: 640px){.region--blog-tiles__wrapper>div{flex-basis:50%}.region--blog-tiles__wrapper>div:not(:nth-child(even)){border-right:6px solid #fff}}@media only screen and (min-width: 860px){.region--blog-tiles__wrapper>div{flex-basis:25%}.region--blog-tiles__wrapper>div:not(:last-child){border-right:6px solid #fff}}.region--blog-tiles__wrapper>div a{display:block;width:100%}.region--blog-tiles__view-all-link{padding:1em;text-align:center}.region--blog-tiles--all .region--blog-tiles--all__tiles{display:flex;flex-wrap:wrap;justify-content:flex-start}.region--blog-tiles--all .region--blog-tiles--all__tiles>div{padding:1em;width:100%}@media only screen and (min-width: 640px){.region--blog-tiles--all .region--blog-tiles--all__tiles>div{width:50%}}@media only screen and (min-width: 860px){.region--blog-tiles--all .region--blog-tiles--all__tiles>div{width:33.333%}}.region--blog-tiles--latest .region--blog-tiles--latest__wrapper{display:flex;flex-wrap:wrap;justify-content:space-between}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper{flex-direction:column;height:700px}}.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest{margin-bottom:.5em;width:100%}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest{align-self:flex-end;margin:0;width:50%}}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest:first-child{align-self:flex-start}}.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest,.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest a{height:300px}@media only screen and (min-width: 640px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest,.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest a{border:0;height:450px}}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest,.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest a{height:350px}}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest:first-child,.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest:first-child a{height:700px}}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest:first-child a{border-right:6px solid #fff}}@media only screen and (min-width: 860px){.region--blog-tiles--latest .region--blog-tiles--latest__wrapper .tile--blog--latest:nth-child(2) a{border-bottom:6px solid #fff}}.region--case-study-blocks .region--case-study-blocks__title{color:#06282d;margin-bottom:1.5em}.region--case-study-blocks .region--case-study-blocks__case-studies{display:flex;flex-wrap:wrap;justify-content:center}@media only screen and (min-width: 860px){.region--case-study-blocks .region--case-study-blocks__case-studies{justify-content:space-between}}.region--case-study-blocks .region--case-study-blocks__case-studies>div{width:100%}@media only screen and (min-width: 860px){.region--case-study-blocks .region--case-study-blocks__case-studies>div{width:49%}}.region--case-study-blocks .region--case-study-blocks__case-studies .case-study-block{margin-bottom:3em}.region--case-study-blocks .region--case-study-blocks__case-studies .case-study-block__title{font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:700;margin-bottom:0}.region--case-study-blocks .region--case-study-blocks__case-studies .region--case-study-blocks__cta{margin-top:0}@media only screen and (min-width: 860px){.region--case-study-blocks .region--case-study-blocks__case-studies .region--case-study-blocks__cta{margin-top:0}}.region--case-study-blocks .region--case-study-blocks__case-studies .region--case-study-blocks__cta a{font-size:1em}@media only screen and (min-width: 450px){.region--case-study-blocks .region--case-study-blocks__case-studies .region--case-study-blocks__cta a{font-size:1.25em}}@media only screen and (min-width: 860px){.region--case-study-blocks .region--case-study-blocks__case-studies .region--case-study-blocks__cta a{margin-bottom:134px}}@media only screen and (min-width: 640px){.region--case-study-blocks.region--case-study-blocks--small .region--case-study-blocks__case-studies{justify-content:flex-start}}.region--case-study-blocks.region--case-study-blocks--small .region--case-study-blocks__case-studies>div{padding:1em}@media only screen and (min-width: 640px){.region--case-study-blocks.region--case-study-blocks--small .region--case-study-blocks__case-studies>div{width:50%}}@media only screen and (min-width: 860px){.region--case-study-blocks.region--case-study-blocks--small .region--case-study-blocks__case-studies>div{width:33.333%}}.region--centered-paragraph .region--centered-paragraph__text{color:#06282d;margin:0 auto;max-width:500px;padding:2em;text-align:center}.region--centered-paragraph--white{background-color:#fff}.region--header{background-color:rgba(255,255,255,0.9);min-height:5.25em;width:100%;z-index:999}.region--header a{text-decoration:none}.region--header .region--header__wrapper{max-width:1440px;margin-left:auto;margin-right:auto;position:relative;z-index:9999}.region--header .region--header__wrapper::after{clear:both;content:"";display:block}.region--header .region--header__logo{display:inline-block;float:left;height:5.25em;margin:0;padding-left:1em}@media only screen and (min-width: 640px){.region--header .region--header__logo{padding-left:1.5em;padding-right:1em}}.region--post-aside{margin-top:3em}@media only screen and (min-width: 860px){.region--post-aside{float:left;margin-top:0;width:33.333%}}.region--post-aside .region--post-aside__section{padding:3em 1em}@media only screen and (min-width: 860px){.region--post-aside .region--post-aside__section{padding:3em 1.5em}}@media only screen and (min-width: 1120px){.region--post-aside .region--post-aside__section{padding:3em 2em}}.region--post-aside .region--post-aside__section__wrapper--posts{border-bottom:solid 1px #bdc2c3}.region--post-aside .region--post-aside__section__wrapper--posts .tile--blog__hover{margin:0;width:100%}@media only screen and (min-width: 640px){.region--post-aside .region--post-aside__section__items{display:flex;justify-content:space-between}}@media only screen and (min-width: 860px){.region--post-aside .region--post-aside__section__items{display:block}}.region--post-aside .region--post-aside__section__items>div{margin-bottom:1em}@media only screen and (min-width: 640px){.region--post-aside .region--post-aside__section__items>div{flex-grow:0;margin-bottom:0;width:48.5%}}@media only screen and (min-width: 860px){.region--post-aside .region--post-aside__section__items>div{margin-bottom:1em;width:100%}}.region--post-aside h2{font-weight:400}.region--post-aside .region--post-aside__section--case-studies .case-study-block__title{font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:400}.region--post-aside .region--post-aside__section--case-studies__cta{margin-top:3em}.region.region--service-icons{align-content:flex-start;display:flex;flex-wrap:wrap;justify-content:space-between;padding-bottom:1.5em;padding-top:1.5em;width:100%}.region.region--service-icons>div{align-content:center;display:flex;flex:1;flex-basis:50%;justify-content:flex-start;margin:.5em 0;width:50%}@media only screen and (min-width: 640px){.region.region--service-icons>div{flex-basis:25%;margin:0;width:25%}}.region--service-tiles{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:.25em}.region--service-tiles>div{border-bottom:6px solid #fff;display:flex;flex-basis:100%;width:100%}@media only screen and (min-width: 640px){.region--service-tiles>div{flex-basis:50%;width:50%}.region--service-tiles>div:first-child .tile--service__link,.region--service-tiles>div:nth-child(3) .tile--service__link{border-right:6px solid #fff}}.region--service-tiles>div .tile--service__link{width:100%}@media only screen and (min-width: 1440px){.region--service-tiles>div:first-child .tile--service__link,.region--service-tiles>div:nth-child(3) .tile--service__link{display:flex;justify-content:flex-end}}.page--blog .region--banner--heading{margin-bottom:6px}.page--blog .region--banner--heading h1::after{background:#d3281b;content:'';display:block;height:1px;margin:10px 0 .5em;width:30px}@media only screen and (min-width: 860px){.page--blog .page--blog__wrapper{display:flex}}@media only screen and (min-width: 860px){.page--blog .page--blog__wrapper .region--blog-tiles--all{flex-basis:75%}}@media only screen and (min-width: 860px){.page--blog .page--blog__wrapper .region--blog-tiles--all .region--blog-tiles--all__tiles>div{width:50%}}@media only screen and (min-width: 1120px){.page--blog .page--blog__wrapper .region--blog-tiles--all .region--blog-tiles--all__tiles>div{width:33.333%}}@media only screen and (min-width: 860px){.page--blog .page--blog__wrapper .region--blog-topics{flex-basis:25%}}.page--blog .region--blog-tiles--latest,.page--blog .region--footer{margin-top:0}.page--blog .pagination{margin-top:3em}.page--blog .region--banner--open-source{margin-bottom:0}.page--case-study{color:#06282d}.page--case-study header{position:absolute}.page--case-study .case-study__header{background-color:#fff;background-position:right bottom;background-repeat:no-repeat;background-size:160%;display:flex;flex-direction:column;justify-content:center;padding-bottom:60%;padding-top:84px}@media only screen and (min-width: 640px){.page--case-study .case-study__header{background-position:65% center;background-size:cover;min-height:calc(50vh - 84px);padding-bottom:0}}@media only screen and (min-width: 1120px){.page--case-study .case-study__header{background-position:right center}}.page--case-study .case-study__header .case-study__header__wrapper{display:flex;justify-content:flex-start;max-width:1440px;padding:2em 1em}.page--case-study .case-study__header .case-study__header__text{color:#06282d;flex-basis:100%}@media only screen and (min-width: 640px){.page--case-study .case-study__header .case-study__header__text{flex-basis:44%}}.page--case-study .case-study__header .case-study__header__text h1{color:#06282d;font-size:1.75em}@media only screen and (min-width: 640px){.page--case-study .case-study__header .case-study__header__text h1{font-size:2.074em}}@media only screen and (min-width: 860px){.page--case-study .case-study__header .case-study__header__text p{font-size:1.25em}}.page--case-study .case-study__client-highlights,.page--case-study .case-study__objective-approach,.page--case-study .case-study__results{display:flex;margin:3em auto;max-width:1440px}.page--case-study .case-study__client-highlights>div,.page--case-study .case-study__objective-approach>div,.page--case-study .case-study__results>div{padding:1em}@media only screen and (min-width: 640px){.page--case-study .case-study__client-highlights div:first-child,.page--case-study .case-study__objective-approach div:first-child,.page--case-study .case-study__results div:first-child{padding-right:3em}}.page--case-study .case-study__client-highlights h2,.page--case-study .case-study__objective-approach h2,.page--case-study .case-study__results h2{color:#06282d;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:700}.page--case-study .case-study__client-highlights{flex-grow:0;flex-shrink:0;flex-wrap:wrap}@media only screen and (min-width: 640px){.page--case-study .case-study__client-highlights{flex-wrap:nowrap}}.page--case-study .case-study__client-highlights .case-study__client-highlights__client{color:#565d5e;flex-basis:100%}@media only screen and (min-width: 640px){.page--case-study .case-study__client-highlights .case-study__client-highlights__client{flex-basis:50%;flex-wrap:nowrap;padding-right:6em}}@media only screen and (min-width: 1120px){.page--case-study .case-study__client-highlights .case-study__client-highlights__client{flex-basis:66.66%}}.page--case-study .case-study__client-highlights .case-study__client-highlights__client img{display:block;height:auto;margin:0 1em 1em 0;max-width:200px}@media only screen and (min-width: 860px){.page--case-study .case-study__client-highlights .case-study__client-highlights__client img{display:inline-block;float:left;margin:0 2em 1em 0}}.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights{display:flex;flex-basis:100%;flex-direction:column}@media only screen and (min-width: 640px){.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights{flex-basis:50%;flex-wrap:nowrap}}@media only screen and (min-width: 1120px){.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights{flex-basis:33.33%}}.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights h2{border-bottom:solid 1px #06282d}.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights ul{margin:0}.page--case-study .case-study__client-highlights .case-study__client-highlights__highlights ul li{color:#06282d;list-style:none}.page--case-study .case-study__objective-approach{flex-grow:0;flex-shrink:0;flex-wrap:wrap}@media only screen and (min-width: 640px){.page--case-study .case-study__objective-approach{flex-wrap:nowrap}}.page--case-study .case-study__objective-approach .case-study__objective-approach__objective,.page--case-study .case-study__objective-approach .case-study__objective-approach__approach{display:flex;flex-basis:100%;flex-direction:column}@media only screen and (min-width: 640px){.page--case-study .case-study__objective-approach .case-study__objective-approach__objective,.page--case-study .case-study__objective-approach .case-study__objective-approach__approach{flex-basis:50%;flex-wrap:nowrap}}.page--case-study .case-study__results{flex-grow:0;flex-shrink:0;flex-wrap:wrap}@media only screen and (min-width: 640px){.page--case-study .case-study__results{flex-wrap:nowrap}}.page--case-study .case-study__results .case-study__results__results,.page--case-study .case-study__results .case-study__results__details{display:flex;flex-basis:100%;flex-direction:column}@media only screen and (min-width: 640px){.page--case-study .case-study__results .case-study__results__results,.page--case-study .case-study__results .case-study__results__details{flex-basis:50%;flex-wrap:nowrap}}.page--case-study .region--client-quote--last{margin-bottom:0}.page--case-study .pagination{margin-bottom:3em;margin-top:0}@media only screen and (min-width: 640px){.page--contact__content{max-width:80%}}@media only screen and (min-width: 860px){.page--contact__content{max-width:1400px}}@media only screen and (min-width: 860px){.page--contact__content .page--contact__content-wrapper{display:flex;justify-content:space-between}}@media only screen and (min-width: 860px){.page--contact__copy{margin-right:1.5em;max-width:350px}}.page--contact__copy .table--minimal--contact{margin-top:1.5em}.page--contact__copy .table--minimal__first-column{width:33.333%}.page--contact__copy .table--minimal--contact__label{font-weight:bold}.page--contact__image{text-align:center}@media only screen and (min-width: 860px){.page--contact__image{flex-basis:50%;text-align:right}}.page--contact__image img{display:block;margin-bottom:3em}.page--contact__image h2{font-weight:400;margin-bottom:0}.page--contact__image a{color:#d3281b}.page--contact__image a:hover,.page--contact__image a:focus{color:#9e023b}.page--home header{position:absolute;top:0}.page--home .region--case-study-tiles{margin-top:0}.page--home .tile--title--blog,.page--home .tile--blog{flex-basis:300px;flex-grow:1}@media only screen and (min-width: 860px){.page--home .tile--title--blog,.page--home .tile--blog{width:25%}}.page--basic .page--basic__content{padding:1.5em 1em 3em}@media only screen and (min-width: 860px){.page--basic .page--basic__content{width:calc(66.6666666667% - 33.3333333333px);float:left;margin-left:20px;left:calc(16.6666666667% - 23.3333333333px + 20px);position:relative}}.page--basic .page--basic__title{margin:1.25em 0 .25em;text-align:center}.page--basic .region--banner--heading__text h1{margin:0 auto}.page--basic .region--cta{border-top:solid 1px #bdc2c3}@media only screen and (min-width: 860px){.page--basic .region--cta{width:calc(66.6666666667% - 33.3333333333px);float:left;margin-left:20px;left:calc(16.6666666667% - 23.3333333333px + 20px);position:relative}}.region--footer{clear:both}.page--post .region--header{border-bottom:solid 1px #bdc2c3}@media only screen and (min-width: 860px){.page--post .page--post__main{border-right:solid 1px #bdc2c3;float:left;padding-bottom:3em;width:66.666%}}.page--post .page--post__main .region--post-header,.page--post .page--post__main .region--post-content{padding:0 1em}@media only screen and (min-width: 640px){.page--post .page--post__main .region--post-header,.page--post .page--post__main .region--post-content{padding:0 1.5em}}.page--post .page--post__main .region--post-header{margin:3em 0}@media only screen and (min-width: 1120px){.page--post .page--post__main .region--post-header{padding-right:2em}}.page--post .page--post__main .region--post-header .region--post-header__title{font-weight:400;margin-bottom:1.5em}@media only screen and (min-width: 1120px){.page--post .page--post__main .region--post-content{padding:0 4em}}@media only screen and (min-width: 1280px){.page--post .page--post__main .region--post-content{padding:0 5em}}@media only screen and (min-width: 1360px){.page--post .page--post__main .region--post-content{padding:0 7em}}@media only screen and (min-width: 1440px){.page--post .page--post__main .region--post-content{padding:0 8em}}.page--post .page--post__aside{border-bottom:solid 1px #bdc2c3;margin-top:0}@media only screen and (min-width: 860px){.page--post .page--post__aside{border-bottom:0;border-top:0}}.page--post .region--prev-next-links--post{clear:both;display:none}@media only screen and (min-width: 860px){.page--post .region--prev-next-links--post{display:flex}}.page--post .region--prev-next-links--mobile{display:flex;margin-top:3em}@media only screen and (min-width: 860px){.page--post .region--prev-next-links--mobile{display:none}}.page--post .region--footer{margin-top:0}@media only screen and (min-width: 640px){.region--post-header__post-info{display:flex}.region--post-header__post-info>div{width:50%}}.region--post-header__post-info p{font-style:italic;margin-bottom:.25em}.region--post-header__post-info i{margin-right:.5em}.region--post-header__post-info .post-author:not(:first-child){clear:left;margin-top:1em}.region--post-header__post-info .post-author picture{float:left;margin-right:1em}.region--post-header__post-info .post-author picture img{display:block;height:60px;width:60px}.region--post-header__post-info .region--post-header__post-info__stats{clear:both;margin-top:1.5em}@media only screen and (min-width: 640px){.region--post-header__post-info .region--post-header__post-info__stats{clear:none;margin-top:0}}.region--post-header__post-info .region--post-header__post-info__stats p{display:inline-block;margin-right:1em}@media only screen and (min-width: 640px){.region--post-header__post-info .region--post-header__post-info__stats p{display:block;margin-right:0}}.page--service .region--header{border-bottom:solid 1px #0f7993}.page--service .region.region--service-icons{border-bottom:solid 1px #0f7993;padding:.25em 0 0}.page--service .page--service__content{background-position:calc(100% + 80px) center;background-repeat:no-repeat;background-size:contain;margin:0 auto;max-width:1400px}@media only screen and (min-width: 860px){.page--service .page--service__content{background-position:right center}}.page--service .page--service__content .page--service__content__main{background-color:#fff;width:100%}@media only screen and (min-width: 640px){.page--service .page--service__content .page--service__content__main{padding-bottom:3em;width:66.666%}}@media only screen and (min-width: 1120px){.page--service .page--service__content .page--service__content__main{width:66.666%}}.page--service .page--service__content .page--service__content__main .page--service__content__text{padding:3em 1em}@media only screen and (min-width: 860px){.page--service .page--service__content .page--service__content__main .page--service__content__text{padding:1.5em 1em 1em}}@media only screen and (min-width: 1120px){.page--service .page--service__content .page--service__content__main .page--service__content__text{padding:3em}}@media only screen and (min-width: 1440px){.page--service .page--service__content .page--service__content__main .page--service__content__text{padding:4.5em 3em 1.5em}}@media only screen and (min-width: 860px){.page--service .page--service__content .page--service__content__main .page--service__content__text h1{margin:.67em 0}}.page--service .page--service__content .page--service__content__main .page--service__content__text .page--service__content__services{padding:1.5em 0 3em}@media only screen and (min-width: 1120px){.page--service .page--service__content .page--service__content__main .page--service__content__text .page--service__content__services{padding:3em 0}}.page--service .region--client-quote{margin-top:0}.page--service .region--blog-tiles{margin:0}.page--service .case-study-block__title{font-size:1.44em}@media only screen and (min-width: 640px){.page--service .case-study-block__title{font-size:1.563em}}.page--service .region--footer{margin-top:0}.page--services .region--hero,.page--durham .region--hero{margin-bottom:0}.page--services .region--client-quote,.page--durham .region--client-quote{margin:0;padding:0}.page--tag .tag__related-case-studies{padding-bottom:0}.page--tag .view-more-link a{text-transform:uppercase;margin-bottom:3em}.page--tag .view-more-link a::after{content:'\f105';font-family:FontAwesome;font-size:1.25em;margin-left:.75em}@media only screen and (min-width: 640px){.page--tag .view-more-link a{background-color:transparent;border:solid 2px #d3281b;border-radius:0;color:#d3281b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1.25em;padding:.75em 1.5em;text-transform:uppercase;transition:all 0.2s ease-in-out;background-color:transparent;border:solid 2px #d3281b;border-radius:0;color:#d3281b;display:inline-block;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-size:1em;height:64px;line-height:60px;padding:0 70px 0 10px;position:relative;text-align:center;transition:background-color .2s ease-in-out, color .2s ease-in-out, border-color .2s ease-in-out}.page--tag .view-more-link a:hover,.page--tag .view-more-link a:focus{background-color:#e6473b;border-color:#e6473b;color:#fff}}@media only screen and (min-width: 640px) and (min-width: 640px){.page--tag .view-more-link a{font-size:1.25em;padding:0 90px 0 30px}}@media only screen and (min-width: 640px){.page--tag .view-more-link a::after{background-color:#d3281b;color:#fff;content:'\f105';font-family:FontAwesome;font-size:1.25em;height:60px;position:absolute;right:0;top:0;transition:background-color 0.2s ease-in-out;width:60px}.page--tag .view-more-link a:hover::after,.page--tag .view-more-link a:focus::after{background-color:#e6473b;color:#fff}}.page--tag .tag__related-posts{padding-bottom:0}.page--tag .region--blog-tiles--all__tiles{margin-bottom:1.5em}.region--team-member-top__wrapper{background-position:center center;background-repeat:no-repeat;background-size:cover}.region--team-member-top{margin:0 auto;max-width:1440px}@media only screen and (min-width: 450px){.region--team-member-top{padding-bottom:3em}}.region--team-member-top__image_name{display:flex;flex-wrap:wrap}.region--team-member-top__image{flex-basis:100%;padding:0}@media only screen and (min-width: 450px){.region--team-member-top__image{flex-basis:35%}}@media only screen and (min-width: 1120px){.region--team-member-top__image{flex-basis:30%}}.region--team-member-top__image img{margin-top:0}@media only screen and (min-width: 450px){.region--team-member-top__image img{margin-top:2em}}@media only screen and (min-width: 1120px){.region--team-member-top__image img{padding-right:1em}}.region--team-member-top__name{flex-basis:100%;padding:1em}@media only screen and (min-width: 450px){.region--team-member-top__name{display:flex;flex-basis:65%;flex-direction:column;justify-content:flex-end;padding:0 1em}}@media only screen and (min-width: 1120px){.region--team-member-top__name{flex-basis:70%;padding:1em}}.region--team-member-top__name h1{color:#06282d;font-family:"Roboto Condensed",Arial Narrow,Arial,sans-serif;font-weight:700;line-height:100%;margin-bottom:0}.region--team-member-top__name h1::after{margin:10px 0 .2em}.region--team-member-top__name p{font-weight:300;margin-bottom:0;text-transform:uppercase}@media only screen and (min-width: 1120px){.region--team-member-top__name p{margin-bottom:.75em}}.region--team-member-top__bio_links{display:flex;flex-wrap:wrap}.region--team-member-top__bio_links>div{padding:0 1em}@media only screen and (min-width: 450px){.region--team-member-top__bio_links>div{padding:2em 1em 0}}.region--team-member-top__links{flex-basis:100%}@media only screen and (min-width: 640px){.region--team-member-top__links{flex-basis:35%}}@media only screen and (min-width: 1120px){.region--team-member-top__links{flex-basis:30%}}.region--team-member-top__links ul{align-content:space-around;display:flex;flex-wrap:wrap;justify-content:center;margin:0}@media only screen and (min-width: 640px){.region--team-member-top__links ul{align-content:space-between}}.region--team-member-top__links ul li{display:block;list-style:none;margin-bottom:.5em;padding:.5em 1em}@media only screen and (min-width: 640px){.region--team-member-top__links ul li{display:flex;flex-basis:100%;padding:.5em}}.region--team-member-top__links ul li a{color:#06282d}.region--team-member-top__links ul li a:hover,.region--team-member-top__links ul li a:focus,.region--team-member-top__links ul li aactive{color:#d3281b}.region--team-member-top__bio{flex-basis:100%;font-size:1.1em}@media only screen and (min-width: 640px){.region--team-member-top__bio{flex-basis:65%}}@media only screen and (min-width: 1120px){.region--team-member-top__bio{flex-basis:40%}}.region--team-member-top__badges{align-items:center;display:flex;flex-basis:100%;flex-direction:row;flex-wrap:wrap;justify-content:center}@media only screen and (min-width: 640px){.region--team-member-top__badges{margin-left:35%;width:65%}}@media only screen and (min-width: 1120px){.region--team-member-top__badges{align-items:center;flex-basis:30%;flex-direction:column;flex-wrap:wrap;justify-content:flex-start;margin:0}}.region--team-member-top__badges a{text-align:center}.region--team-member-top__badges img{height:auto;max-width:80%;width:180px}.region--team-member-gallery{display:flex;flex-wrap:wrap;margin:.25em auto;margin-bottom:3em;max-width:1440px}.region--team-member-gallery img{display:block;width:100%}.region--team-member-gallery .region--team-member-gallery__left{flex-basis:100%}@media only screen and (min-width: 450px){.region--team-member-gallery .region--team-member-gallery__left{border-right:0.25em solid #fff;flex-basis:50%}}.region--team-member-gallery .region--team-member-gallery__right{display:flex;flex-basis:100%;flex-direction:column}@media only screen and (min-width: 450px){.region--team-member-gallery .region--team-member-gallery__right{flex-basis:50%}}.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta{align-items:center;display:flex;flex:1;flex-direction:column;justify-content:center;margin:3em auto}@media only screen and (min-width: 450px){.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta{margin:0}}.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta h2{color:#06282d;font-size:1.25em;font-weight:400;margin-bottom:0;padding:.5em 1em;text-transform:uppercase}@media only screen and (min-width: 860px){.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta h2{font-size:1.953em}}.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta a{color:#d3281b}.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta a:hover,.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta a:focus,.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__cta aactive{color:#06282d}.region--team-member-gallery .region--team-member-gallery__right .region--team-member-gallery__landscape{flex:1}.page--team .region--blog-tiles--all{max-width:1440px}.page--team .region--blog-tiles--all .region--blog-tiles--all__tiles>div{padding:.25em}@media only screen and (min-width: 860px){.page--team .region--blog-tiles--all .region--blog-tiles--all__tiles>div{width:25%}}.page--team .region--blog-tiles--all .region--blog-tiles--all__tiles>div .tile--blog__hover{margin:.25em;width:calc(100% - .5em)}
</style>

  
  

  <!-- Start of Async Drift Code -->
  <script>
    !function() {
      var t;
      if (t = window.driftt = window.drift = window.driftt || [], !t.init) return t.invoked ? void (window.console && console.error && console.error("Drift snippet included twice.")) : (t.invoked = !0,
              t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ],
              t.factory = function(e) {
                return function() {
                  var n;
                  return n = Array.prototype.slice.call(arguments), n.unshift(e), t.push(n), t;
                };
              }, t.methods.forEach(function(e) {
        t[e] = t.factory(e);
      }), t.load = function(t) {
        var e, n, o, i;
        e = 3e5, i = Math.ceil(new Date() / e) * e, o = document.createElement("script"),
                o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + i + "/" + t + ".js",
                n = document.getElementsByTagName("script")[0], n.parentNode.insertBefore(o, n);
      });
    }();
    drift.SNIPPET_VERSION = '0.3.1';
    drift.load('iggktw4km6ha');
    drift.config({
      welcomeMessageDelay: 25000
    });
  </script>
  <!-- End of Async Drift Code -->

  <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Optimizing Jekyll Performance with Gulp | Savas Labs</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Optimizing Jekyll Performance with Gulp" />
<meta name="author" content="Anne Tomasevich" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="It’s hard to believe it’s been over a year and a half since our site’s inaugural blog post (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of Jekyll. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in jekyll commands to build the site. Instead, we’re using gulp, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!" />
<meta property="og:description" content="It’s hard to believe it’s been over a year and a half since our site’s inaugural blog post (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of Jekyll. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in jekyll commands to build the site. Instead, we’re using gulp, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!" />
<link rel="canonical" href="https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html" />
<meta property="og:url" content="https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html" />
<meta property="og:site_name" content="Savas Labs" />
<meta property="og:image" content="https://savaslabs.com/assets/img/blog/test-tubes.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-10-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@savaslabs" />
<meta name="twitter:creator" content="@Anne Tomasevich" />
<script type="application/ld+json">
{"description":"It’s hard to believe it’s been over a year and a half since our site’s inaugural blog post (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of Jekyll. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in jekyll commands to build the site. Instead, we’re using gulp, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!","author":{"@type":"Person","name":"Anne Tomasevich"},"@type":"BlogPosting","url":"https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html","image":"https://savaslabs.com/assets/img/blog/test-tubes.jpg","headline":"Optimizing Jekyll Performance with Gulp","dateModified":"2016-10-19T00:00:00+00:00","datePublished":"2016-10-19T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://savaslabs.com/2016/10/19/optimizing-jekyll-with-gulp.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


  <body class="page--post">

    <header class="region--header" role="banner">
  <div class="region--header__wrapper">

    <a href="/" class="region--header__logo">
      <img src="https://savaslabs.com/assets/img/logo.svg" alt="Savas Labs logo" class="savas-logo savas-logo--main">
    </a>

    <!-- Mobile menu button. -->
<a href="/" id="js-mobile-menu" class="header-navigation__mobile-menu-link">MENU</a>

<!-- Main menu. -->
<nav role="navigation" class="header-navigation">
  <ul id="js-navigation-menu" class="header-navigation__menu show">
    
      
      
      
      <li class="header-navigation__menu-link">
        <a href="/careers">We're hiring!</a>
      </li>
    
      
      
      
      <li class="header-navigation__menu-link">
        <a href="/company">Company</a>
      </li>
    
      
      
      
      <li class="header-navigation__menu-link">
        <a href="/results">Results</a>
      </li>
    
      
      
      
      <li class="header-navigation__menu-link">
        <a href="/services">Services</a>
      </li>
    
      
      
      
      <li class="header-navigation__menu-link header-navigation__active-nav-item">
        <a href="/blog">Blog</a>
      </li>
    
      
      
      
      <li class="header-navigation__menu-link">
        <a href="/contact">Contact</a>
      </li>
    
  </ul>
</nav>

  </div>
</header>

    <div class="page-content">
      







<div class="outer-container">
  <div class="page--post__main">
    <div class="region--featured-image">
      
      <picture>
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-1474by912-9446e4.jpg" media="(min-width: 1120px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 1120px) and (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-1000by619-9446e4.jpg" media="(min-width: 1120px)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-1474by912-9446e4.jpg" media="(min-width: 860px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 860px) and (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-746by462-9446e4.jpg" media="(min-width: 860px)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-1474by912-9446e4.jpg" media="(min-width: 640px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 640px) and (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-860by532-9446e4.jpg" media="(min-width: 640px)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-1280by792-9446e4.jpg" media="(min-width: 400px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 400px) and (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-640by396-9446e4.jpg" media="(min-width: 400px)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-800by495-9446e4.jpg" media="(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/blog/test-tubes-400by247-9446e4.jpg">
    <img src="https://savaslabs.com/assets/processed-img/blog/test-tubes-400by247-9446e4.jpg" class="image--post-featured-image" itemprop="image" alt="Test tubes with brightly color liquids inside" >
  </picture>

      
      
    </div>
    <div class="region--post-header">
      <h1 class="region--post-header__title">Optimizing Jekyll Performance with Gulp</h1>
      <div class="region--post-header__post-info">
        <div class="region--post-header__post-info__authors">
          
<div class="post-author">
  <picture>
    <source srcset="https://savaslabs.com/assets/processed-img/team/team-former/anne/anne-square-outside-120by122-bebfe8.jpg" media="(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/team/team-former/anne/anne-square-outside-60by61-bebfe8.jpg">
    <img src="https://savaslabs.com/assets/processed-img/team/team-former/anne/anne-square-outside-60by61-bebfe8.jpg" class="image--team-blog-tile" itemprop="image" alt="Anne Tomasevich" >
  </picture>

  <p class="post-author__name">Anne Tomasevich</p>
</div>

        </div>
        <div class="region--post-header__post-info__stats">
          <p><i class="fa fa-calendar"></i>Oct 19, 2016 </p>
          <p><i class="fa fa-tags"></i><a href="/blog/tag/performance/">Performance</a>, <a href="/blog/tag/jekyll/">Jekyll</a>, <a href="/blog/tag/javascript/">Javascript</a>, <a href="/blog/tag/css/">CSS</a>, <a href="/blog/tag/sass/">Sass</a>, <a href="/blog/tag/front-end-dev/">Front End Development</a></p>
          
          <p><span id="js-comment-count"></span></p>
          
        </div>
      </div>
      
    </div>
    <article class="region--post-content">
      <p>It’s hard to believe it’s been over a year and a half since our site’s <a href="https://savaslabs.com/2015/04/01/building-our-site.html">inaugural blog post</a> (written just two months after my career change into web development!) It’s been great fun building our site and adding content thanks to the power and simplicity of <a href="https://jekyllrb.com/">Jekyll</a>. We recently deployed a series of changes to optimize our CSS, JS, and images, and in doing so finally moved away from using built-in <code class="highlighter-rouge">jekyll</code> commands to build the site. Instead, we’re using <a href="http://gulpjs.com/">gulp</a>, a task runner — or, as they put so nicely on their website, a “streaming build system”. In this post I’ll go over our motivations for this change, how we integrated gulp with Jekyll, and the awesome results!</p>

<p>We based a lot of our gulp workflow on
<a href="https://robwise.github.io/blog/jekyll-and-gulp">this excellent post</a> by Rob Wise.
Our workflow includes a few additional features like:</p>

<ul>
  <li>Separate gulp tasks for building the site locally,
for testing purposes, and for production</li>
  <li>Some updated gulp plugins</li>
  <li>Inlining of critical CSS</li>
  <li>Some further improvements to responsive images</li>
</ul>

<p>…but I’d definitely recommend his post and you’ll see some of his code and
architecture throughout this article.</p>

<p>To see all of our current code, pop over to our
<a href="https://github.com/savaslabs/savaslabs.github.io">GitHub repo</a>.</p>

<h2 id="motivation">Motivation</h2>

<p>We know how important site performance is to
<a href="http://alistapart.com/article/improving-ux-through-front-end-performance">user experience</a>.
We’ve been showing this to our clients for years, and we finally found the time
to be able to practice what we preach!</p>

<p>Our ultimate motivator was our not-so-great Google PageSpeed score.</p>

<p><img src="https://savaslabs.com/assets/img/blog/pagespeed-insights-initial.jpg" alt="Initial Google PageSpeed Insights score for savaslabs.com. Several significant problems exist!" class="blog-image-full-width" />
<span class="caption">Yikes!</span></p>

<p>Going off of these recommendations and adding a few things of our own, we ended
up with a nice to-do list:</p>

<ol>
  <li>Optimize CSS:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Minification_(programming)">Minify</a> our main
CSS file to remove unnecessary characters and shrink the filesize.</li>
      <li>Use autoprefixer to add
<a href="https://developer.mozilla.org/en-US/docs/Glossary/Vendor_Prefix">vendor prefixes</a>
(since this will be required for the soon-to-come Bourbon v5.0).</li>
      <li>To prevent our large CSS file from delaying the initial render for the end
user, insert CSS that’s critical to above-the-fold content into the HTML
head. By “above the fold” I mean content viewable to the user on the initial
page load before interacting with the site.</li>
    </ul>
  </li>
  <li>Optimize JS:
    <ul>
      <li>Concatenate and <a href="https://github.com/mishoo/UglifyJS">uglify</a> our JS files
to create a single, minified file, smaller than the larger files we started with.</li>
      <li>Execute our JS asynchronously, meaning it will be executed when it’s ready
while the page is loading without interfering with the render.</li>
    </ul>
  </li>
  <li>Optimize images:
    <ul>
      <li>Manually shrink our image file sizes, then set up gulp to
<a href="https://github.com/imagemin/imagemin">optimize</a> them even further for the
smallest images possible.</li>
      <li>Use the <code class="highlighter-rouge">&lt;picture&gt;</code> element over simple <code class="highlighter-rouge">&lt;img&gt;</code> tags. The <code class="highlighter-rouge">&lt;picture&gt;</code>
 element contains an array of different sizes of the same image and allows
 the browser to pick the smallest one that will look good on the user’s
 screen size and resolution, so only the smallest possible image is loaded.</li>
    </ul>
  </li>
</ol>

<p>One thing reported by PageSpeed not yet on our to-do list is “leverage
browser caching” — we’re not going to tackle this just yet since we’re using
GitHub Pages to host our site and we don’t have control over caching headers. On
a side note, if you have a solution to this problem, please leave us a comment!</p>

<p>From here I’ll go over how we set up gulp to work with our Jekyll site, then how
we used gulp to accomplish the tasks above.</p>

<h2 id="initial-setup">Initial setup</h2>

<h3 id="changes-to-jekyll-directory-structure">Changes to Jekyll directory structure</h3>

<p>Our fonts, images, scripts, and SCSS files were previously stored in a directory
called <code class="highlighter-rouge">assets</code>. The <code class="highlighter-rouge">jekyll build</code> command would copy this directory into the
<code class="highlighter-rouge">_site</code> folder so the assets within could be included in HTML files and used to
theme the site.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/Sites/savaslabs.com/assets <span class="nv">$ </span>tree <span class="nt">-L</span> 1
<span class="nb">.</span>
├── fonts
├── img
├── js
└── styles
</code></pre></div></div>

<p>Since we’re going to be processing our assets with gulp instead, we moved the
<code class="highlighter-rouge">assets</code> directory to <code class="highlighter-rouge">_assets</code> to indicate that it should be ignored by Jekyll.</p>

<p>Our basic workflow is to use gulp to process the contents of <code class="highlighter-rouge">_assets</code>,
outputting them into a git-ignored directory <code class="highlighter-rouge">assets</code> which will be copied by
Jekyll into the generated <code class="highlighter-rouge">_site</code> directory. In addition, for local development
we created a <code class="highlighter-rouge">gulp serve</code> task using <code class="highlighter-rouge">gulp.watch()</code> to process assets as
they’re updated and copy them directly into the <code class="highlighter-rouge">_site</code> directory, then push the
changes to the browser via BrowserSync.</p>

<p><img src="https://savaslabs.com/assets/img/blog/gulp-workflow.svg" alt="Diagram of our basic gulp workflow" class="blog-image-full-width" /></p>

<h3 id="changes-to-jekyll-config">Changes to Jekyll config</h3>

<p>We also needed to make some updates to our Jekyll config:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Delete this since Jekyll is no longer processing sass.</span>
<span class="na">sass</span><span class="pi">:</span>
  <span class="na">sass_dir</span><span class="pi">:</span> <span class="s">assets/styles</span>

<span class="c1"># Exclude the following from the Jekyll build process.</span>
<span class="c1"># Note: "vendor" is for Travis CI.</span>
<span class="na">exclude</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">vendor"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">_assets"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">Gemfile"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">Gemfile.lock"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">gulpfile.js"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">node_modules"</span><span class="pi">,</span>
          <span class="s2">"</span><span class="s">package.json"</span><span class="pi">]</span>
</code></pre></div></div>

<p>I’d also like to note that we’re using a few different config files: our default
<code class="highlighter-rouge">_config.yml</code>, <code class="highlighter-rouge">_config.test.yml</code> which uses blank URL and base URL variables so
tests can be run locally, and <code class="highlighter-rouge">_config.dev.yml</code> which sets variables for our
local <a href="https://github.com/savaslabs/squabble">comment server</a> for development
purposes. These different config files will come into play as we set up the
gulpfile.</p>

<p>Finally, we updated our <code class="highlighter-rouge">.gitignore</code> to include the following:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code># .gitignore
node_modules
assets
</code></pre></div></div>

<p><code class="highlighter-rouge">node_modules</code> will hold all of our node.js dependencies, and <code class="highlighter-rouge">assets</code> is the
directory that will be generated by gulp and copied by Jekyll into the <code class="highlighter-rouge">_site</code>
directory. The <code class="highlighter-rouge">assets</code> directory (no underscore) will hold processed asset
files and we’ll only be keeping the unprocessed files (the <code class="highlighter-rouge">_assets</code> directory)
in version control.</p>

<h3 id="paths-file">Paths file</h3>

<p>This comes straight from <a href="https://robwise.github.io/blog/jekyll-and-gulp">Rob’s post</a>
and is a great organization technique. In the <code class="highlighter-rouge">_assets</code> directory, I created a
directory called <code class="highlighter-rouge">gulp_config</code> to hold <code class="highlighter-rouge">paths.js</code>, a list of all the paths we’ll
need set to javascript variables to be used in the gulpfile. We’re going to be
piping a lot of files to and from gulp tasks and they’ll need to land in very
specific locations so settings these variables in one place will keep us
consistent.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// paths.js file</span>

<span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="p">{};</span>

<span class="c1">// Directory locations.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">assetsDir</span>       <span class="o">=</span> <span class="s1">'_assets/'</span><span class="p">;</span>      <span class="c1">// The files Gulp will handle.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDir</span>       <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>              <span class="c1">// The files Jekyll will handle.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllAssetsDir</span> <span class="o">=</span> <span class="s1">'assets/'</span><span class="p">;</span>       <span class="c1">// The asset files Jekyll will handle.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteDir</span>         <span class="o">=</span> <span class="s1">'_site/'</span><span class="p">;</span>        <span class="c1">// The resulting static site.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteAssetsDir</span>   <span class="o">=</span> <span class="s1">'_site/assets/'</span><span class="p">;</span> <span class="c1">// The resulting static site's assets.</span>

<span class="c1">// Folder naming conventions.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">postFolderName</span>   <span class="o">=</span> <span class="s1">'_posts'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">draftFolderName</span>  <span class="o">=</span> <span class="s1">'_drafts'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">fontFolderName</span>   <span class="o">=</span> <span class="s1">'fonts'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">imageFolderName</span>  <span class="o">=</span> <span class="s1">'img'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">scriptFolderName</span> <span class="o">=</span> <span class="s1">'js'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">stylesFolderName</span> <span class="o">=</span> <span class="s1">'styles'</span><span class="p">;</span>

<span class="c1">// Asset files locations.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span>   <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">assetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">stylesFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jsFiles</span>     <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">assetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">scriptFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">imageFiles</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">assetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imageFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">fontFiles</span>   <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">assetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">fontFolderName</span><span class="p">;</span>

<span class="c1">// Jekyll files locations.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllPostFiles</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDir</span>       <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">postFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDraftFiles</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDir</span>       <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">draftFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllCssFiles</span>   <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">stylesFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllJsFiles</span>    <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">scriptFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllImageFiles</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imageFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllFontFiles</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">fontFolderName</span><span class="p">;</span>

<span class="c1">// Site files locations.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteCssFiles</span>   <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">stylesFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteJsFiles</span>    <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">scriptFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteImageFiles</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imageFolderName</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteFontFiles</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteAssetsDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">fontFolderName</span><span class="p">;</span>

<span class="c1">// Glob patterns by file type.</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">sassPattern</span>     <span class="o">=</span> <span class="s1">'/**/*.scss'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jsPattern</span>       <span class="o">=</span> <span class="s1">'/**/*.js'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">imagePattern</span>    <span class="o">=</span> <span class="s1">'/**/*.+(jpg|JPG|jpeg|JPEG|png|PNG|svg|SVG|gif|GIF|webp|WEBP|tif|TIF)'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">markdownPattern</span> <span class="o">=</span> <span class="s1">'/**/*.+(md|MD|markdown|MARKDOWN)'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">htmlPattern</span>     <span class="o">=</span> <span class="s1">'/**/*.html'</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">xmlPattern</span>      <span class="o">=</span> <span class="s1">'/**/*.xml'</span><span class="p">;</span>

<span class="c1">// Asset files globs</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">sassFilesGlob</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span>  <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">sassPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jsFilesGlob</span>    <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jsFiles</span>    <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jsPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">imageFilesGlob</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imageFiles</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imagePattern</span><span class="p">;</span>

<span class="c1">// Jekyll files globs</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllPostFilesGlob</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllPostFiles</span>  <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">markdownPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDraftFilesGlob</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDraftFiles</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">markdownPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllHtmlFilesGlob</span>  <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDir</span>        <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">htmlPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllXmlFilesGlob</span>   <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllDir</span>        <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">xmlPattern</span><span class="p">;</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllImageFilesGlob</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllImageFiles</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">imagePattern</span><span class="p">;</span>

<span class="c1">// Site files globs</span>
<span class="nx">paths</span><span class="p">.</span><span class="nx">siteHtmlFilesGlob</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteDir</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">htmlPattern</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">;</span>
</code></pre></div></div>

<p>Later we’ll include this file in our gulpfile so the variables can be accessed.</p>

<h3 id="install-dependencies">Install dependencies</h3>

<p>The first requirements are node.js and npm, which you can learn about installing <a href="https://docs.npmjs.com/getting-started/installing-node">here</a>.</p>

<p>Getting gulp set up is a matter of a few commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install gulp globally.</span>
<span class="nv">$ </span>npm install <span class="nt">-g</span> gulp

<span class="c"># Initialize the project, following the prompts</span>
<span class="c"># (most of which can be left blank and filled in later).</span>
<span class="nv">$ </span>npm init

<span class="c"># Now that package.json has been created, start adding dependencies.</span>
<span class="nv">$ </span>npm install <span class="nt">--save-dev</span> gulp

<span class="c"># Create a gulpfile in the root of the repository.</span>
<span class="nv">$ </span>touch gulpfile.js
</code></pre></div></div>

<h3 id="set-variables-and-include-paths">Set variables and include paths</h3>

<p>In the gulpfile, we’ll start by setting up variables for the gulp plugins we’ll
be using and including our paths file.</p>

<p>(P.S. If you’re like me, you might find it easier to look at the entire gulpfile
at once - you can view ours <a href="https://github.com/savaslabs/savaslabs.github.io/blob/926c11c60eeb774b9644fb72ee1e8383e3a09bb8/gulpfile.js">on GitHub</a>.)</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// gulpfile.js</span>

<span class="c1">// Define variables.</span>
<span class="kd">var</span> <span class="nx">autoprefixer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'autoprefixer'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">browserSync</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'browser-sync'</span><span class="p">).</span><span class="nx">create</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">cleancss</span>     <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-clean-css'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">concat</span>       <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-concat'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">del</span>          <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'del'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">gulp</span>         <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">gutil</span>        <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-util'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">imagemin</span>     <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-imagemin'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">notify</span>       <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-notify'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">postcss</span>      <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-postcss'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">rename</span>       <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-rename'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">run</span>          <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-run'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">runSequence</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'run-sequence'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sass</span>         <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-ruby-sass'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">uglify</span>       <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-uglify'</span><span class="p">);</span>

<span class="c1">// Include paths file.</span>
<span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./_assets/gulp_config/paths'</span><span class="p">);</span>
</code></pre></div></div>

<p>Each plugin will need to be installed locally either by copying our
<a href="https://github.com/savaslabs/savaslabs.github.io/blob/84ff592ff2fc8c9bf57b1226c76df66bb9d53b25/gulpfile.js"><code class="highlighter-rouge">packages.json</code></a>
file and running <code class="highlighter-rouge">npm install</code>, or by running the following for each
plugin:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm install <span class="nt">--save-dev</span> <span class="o">[</span>plugin-name]
</code></pre></div></div>

<p>This will install the package and add it to the <code class="highlighter-rouge">package.json</code> file.</p>

<h2 id="gulp-tasks">Gulp tasks</h2>

<p>Below is an outline of the gulp tasks we’ll be writing. From here, I’ll go
through each individual task, then the default <code class="highlighter-rouge">gulp</code> and <code class="highlighter-rouge">gulp serve</code> commands
that tie the tasks together to build the site or serve it locally.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// gulpfile.js</span>

<span class="c1">// Processes SCSS.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:styles:main'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Compile SCSS, run autoprefixer, and minify CSS.</span>
<span class="p">});</span>

<span class="c1">// Creates critical CSS file.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:styles:critical'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Compile critical SCSS rules, run autoprefixer, minify CSS, and place in</span>
  <span class="c1">// appropriate location so it can be inlined in the HTML head.</span>
<span class="p">});</span>

<span class="c1">// Processes JS.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:scripts'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Concatenate and uglify JS.</span>
<span class="p">});</span>

<span class="c1">// Optimizes images.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:images'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Run imagemin.</span>
<span class="p">});</span>

<span class="c1">// Runs jekyll build command.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:jekyll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Run bundle exec jekyll build with appropriate config file.</span>
<span class="p">});</span>

<span class="c1">// Builds site anew.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Run all build tasks.</span>
<span class="p">});</span>

<span class="c1">// Default Task: builds site.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build'</span><span class="p">]);</span>

<span class="c1">// Serves site and watches files.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'serve'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build'</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Watch for changes and run appropriate build tasks when needed.</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="handle-css">Handle CSS</h3>

<p>Jekyll compiles SCSS out of the box, but using gulp to process our SCSS gives us the power to do other useful things like minify our CSS, add vendor prefixes, and direct our critical CSS to the <code class="highlighter-rouge">&lt;head&gt;</code> element.</p>

<h4 id="process-all-scss">Process all SCSS</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Uses Sass compiler to process styles, adds vendor prefixes, minifies, then</span>
<span class="c1">// outputs file to the appropriate location.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:styles:main'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sass</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span> <span class="o">+</span> <span class="s1">'/main.scss'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">style</span><span class="p">:</span> <span class="s1">'compressed'</span><span class="p">,</span>
        <span class="na">trace</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">loadPath</span><span class="p">:</span> <span class="p">[</span><span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span><span class="p">]</span>
    <span class="p">}).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">postcss</span><span class="p">([</span> <span class="nx">autoprefixer</span><span class="p">({</span> <span class="na">browsers</span><span class="p">:</span> <span class="p">[</span><span class="s1">'last 2 versions'</span><span class="p">]</span> <span class="p">})</span> <span class="p">]))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">cleancss</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllCssFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">siteCssFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">browserSync</span><span class="p">.</span><span class="nx">stream</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This task will output <code class="highlighter-rouge">main.css</code> in <code class="highlighter-rouge">_site/assets/styles</code>.</p>

<p>Some notes:</p>

<ul>
  <li>We’re including all our SCSS partials in our <a href="https://github.com/savaslabs/savaslabs.github.io/blob/220e13c1878b5f2b168d941463ad9d6a332f741a/_assets/styles/main.scss">main.scss</a>
file, but you could point to a directory or file glob if needed.</li>
  <li>We’re using the <a href="https://github.com/postcss/autoprefixer">autoprefixer plugin</a> for postcss. We’re making heavy use of the Bourbon mixin library which currently handles some autoprefixing, but this will be dropped (hopefully soon!) in Bourbon v5.0 at which time <a href="https://github.com/postcss/autoprefixer">autoprefixer will be recommended</a>.</li>
</ul>

<h4 id="critical-css">Critical CSS</h4>

<p>Placing the CSS that’s critical to above-the-fold content in <code class="highlighter-rouge">&lt;style&gt;</code> tags in
the HTML <code class="highlighter-rouge">&lt;head&gt;</code> to means our end user can avoid waiting on the server to load
the full CSS file on the initial page load. Identifying critical styles and
pulling them into a single file may seem daunting but there are a
<a href="https://css-tricks.com/authoring-critical-fold-css/#article-header-id-1">number of ways</a>
to do this automatically. However, we found the easiest way to consolidate
critical styles for all pages on our site was to follow
<a href="https://gomakethings.com/inlining-critical-css-for-better-web-performance/">Chris Ferdinandi’s method</a>
and separate critical styles into their own Sass partials, then include these
partials in a <code class="highlighter-rouge">critical.scss</code> file. This took a
<a href="https://github.com/savaslabs/savaslabs.github.io/commit/53b6d3edbace9ca7a85bd3d3d2e02e88087862b0">little refactoring</a>,
but it certainly didn’t hurt to make our Sass files even more modular.</p>

<p>After we created our <code class="highlighter-rouge">critical.scss</code> file, we added another gulp task to process
it:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Processes critical CSS, to be included in head.html.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:styles:critical'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sass</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span> <span class="o">+</span> <span class="s1">'/critical.scss'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">style</span><span class="p">:</span> <span class="s1">'compressed'</span><span class="p">,</span>
        <span class="na">trace</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">loadPath</span><span class="p">:</span> <span class="p">[</span><span class="nx">paths</span><span class="p">.</span><span class="nx">sassFiles</span><span class="p">]</span>
    <span class="p">}).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">postcss</span><span class="p">([</span> <span class="nx">autoprefixer</span><span class="p">({</span> <span class="na">browsers</span><span class="p">:</span> <span class="p">[</span><span class="s1">'last 2 versions'</span><span class="p">]</span> <span class="p">})</span> <span class="p">]))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">cleancss</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_includes'</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This outputs a (git-ignored) <code class="highlighter-rouge">critical.css</code> file into our <code class="highlighter-rouge">_includes</code> directory.
We added the critical CSS file to our <code class="highlighter-rouge">head.html</code> template:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{# in head.html #}
<span class="nt">&lt;head&gt;</span>
  
  {# Other stuff... #}

  <span class="nt">&lt;style&gt;</span><span class="p">{</span><span class="err">%</span> <span class="err">include</span> <span class="err">critical.css</span> <span class="err">%</span><span class="p">}</span><span class="nt">&lt;/style&gt;</span>
  
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<h4 id="load-css-asynchronously">Load CSS asynchronously</h4>

<p>Next, instead of loading the main CSS file all at once, we used
<a href="https://github.com/filamentgroup/loadCSS">Filament Group’s <code class="highlighter-rouge">loadCSS</code> function</a>
to load the main CSS asynchronously (plus our Google fonts):</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{# in head.html #}
<span class="nt">&lt;head&gt;</span>
  
  {# Other stuff... #}

  <span class="nt">&lt;script&gt;</span>
    <span class="o">!</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="s2">"use strict"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">r</span><span class="p">){</span><span class="kd">function</span> <span class="nx">o</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">i</span><span class="p">.</span><span class="nx">body</span><span class="p">?</span><span class="nx">e</span><span class="p">():</span><span class="k">void</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">o</span><span class="p">(</span><span class="nx">e</span><span class="p">)})}</span><span class="kd">function</span> <span class="nx">l</span><span class="p">(){</span><span class="nx">d</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">"load"</span><span class="p">,</span><span class="nx">l</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">media</span><span class="o">=</span><span class="nx">r</span><span class="o">||</span><span class="s2">"all"</span><span class="p">}</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"link"</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="nx">a</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">body</span><span class="o">||</span><span class="nx">i</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"head"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">childNodes</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">s</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span><span class="kd">var</span> <span class="nx">u</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">;</span><span class="nx">d</span><span class="p">.</span><span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="nx">t</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">media</span><span class="o">=</span><span class="s2">"only x"</span><span class="p">,</span><span class="nx">o</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">n</span><span class="p">?</span><span class="nx">a</span><span class="p">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)});</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">href</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">u</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">--</span><span class="p">;)</span><span class="k">if</span><span class="p">(</span><span class="nx">u</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">href</span><span class="o">===</span><span class="nx">t</span><span class="p">)</span><span class="k">return</span> <span class="nx">e</span><span class="p">();</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">(</span><span class="nx">e</span><span class="p">)})};</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"load"</span><span class="p">,</span><span class="nx">l</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">onloadcssdefined</span><span class="o">=</span><span class="nx">f</span><span class="p">,</span><span class="nx">f</span><span class="p">(</span><span class="nx">l</span><span class="p">),</span><span class="nx">d</span><span class="p">};</span><span class="s2">"undefined"</span><span class="o">!=</span><span class="k">typeof</span> <span class="nx">exports</span><span class="p">?</span><span class="nx">exports</span><span class="p">.</span><span class="nx">loadCSS</span><span class="o">=</span><span class="nx">t</span><span class="p">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">loadCSS</span><span class="o">=</span><span class="nx">t</span><span class="p">}(</span><span class="s2">"undefined"</span><span class="o">!=</span><span class="k">typeof</span> <span class="nb">global</span><span class="p">?</span><span class="nb">global</span><span class="p">:</span><span class="k">this</span><span class="p">),</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">loadCSS</span><span class="p">){</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="nx">loadCSS</span><span class="p">.</span><span class="nx">relpreload</span><span class="o">=</span><span class="p">{};</span><span class="k">if</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">support</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"link"</span><span class="p">).</span><span class="nx">relList</span><span class="p">.</span><span class="nx">supports</span><span class="p">(</span><span class="s2">"preload"</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">t</span><span class="p">){}},</span><span class="nx">t</span><span class="p">.</span><span class="nx">poly</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"link"</span><span class="p">),</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="nx">t</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span><span class="s2">"preload"</span><span class="o">===</span><span class="nx">r</span><span class="p">.</span><span class="nx">rel</span><span class="o">&amp;&amp;</span><span class="s2">"style"</span><span class="o">===</span><span class="nx">r</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">"as"</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">loadCSS</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">href</span><span class="p">,</span><span class="nx">r</span><span class="p">),</span><span class="nx">r</span><span class="p">.</span><span class="nx">rel</span><span class="o">=</span><span class="kc">null</span><span class="p">)}},</span><span class="o">!</span><span class="nx">t</span><span class="p">.</span><span class="nx">support</span><span class="p">()){</span><span class="nx">t</span><span class="p">.</span><span class="nx">poly</span><span class="p">();</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">poly</span><span class="p">,</span><span class="mi">300</span><span class="p">);</span><span class="nx">e</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"load"</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="p">.</span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">n</span><span class="p">)})}}}(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">loadCSS</span><span class="p">(</span><span class="s1">'/assets/styles/main.css'</span><span class="p">);</span>
    <span class="nx">loadCSS</span><span class="p">(</span><span class="s1">'https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro'</span><span class="p">);</span>
  <span class="nt">&lt;/script&gt;</span>

  <span class="nt">&lt;style&gt;</span><span class="p">{</span><span class="err">%</span> <span class="err">include</span> <span class="err">critical.css</span> <span class="err">%</span><span class="p">}</span><span class="nt">&lt;/style&gt;</span>
  
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<p>As a fallback, we’re loading the CSS files normally in <code class="highlighter-rouge">&lt;noscript&gt;</code> tags
in a <code class="highlighter-rouge">scripts.html</code> template that’s included on each page after the footer.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{# in scripts.html #}
<span class="nt">&lt;noscript&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'/assets/styles/main.css'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
<span class="nt">&lt;/noscript&gt;</span>
</code></pre></div></div>

<h4 id="tasks-to-build-all-styles-and-delete-all-styles">Tasks to build all styles and delete all styles</h4>

<p>To wrap things up, we have a task to build all styles, and a task to delete all
styles. These will come into play when we set up our main build and serve tasks.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Builds all styles.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:styles'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:styles:main'</span><span class="p">,</span> <span class="s1">'build:styles:critical'</span><span class="p">]);</span>

<span class="c1">// Deletes CSS.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean:styles'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">del</span><span class="p">([</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllCssFiles</span> <span class="o">+</span> <span class="s1">'main.css'</span><span class="p">,</span>
        <span class="nx">paths</span><span class="p">.</span><span class="nx">siteCssFiles</span> <span class="o">+</span> <span class="s1">'main.css'</span><span class="p">,</span>
        <span class="s1">'_includes/critical.css'</span>
    <span class="p">]);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="process-js-and-load-it-asynchronously">Process JS and load it asynchronously</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Concatenates and uglifies global JS files and outputs result to the</span>
<span class="c1">// appropriate location.</span>
 <span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:scripts'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span>
         <span class="nx">paths</span><span class="p">.</span><span class="nx">jsFiles</span> <span class="o">+</span> <span class="s1">'/global/lib'</span> <span class="o">+</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">jsPattern</span><span class="p">,</span>
         <span class="nx">paths</span><span class="p">.</span><span class="nx">jsFiles</span> <span class="o">+</span> <span class="s1">'/global/*.js'</span>
     <span class="p">])</span>
         <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">concat</span><span class="p">(</span><span class="s1">'main.js'</span><span class="p">))</span>
         <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">uglify</span><span class="p">())</span>
         <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllJsFiles</span><span class="p">))</span>
         <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">siteJsFiles</span><span class="p">))</span>
         <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
 <span class="p">});</span>
</code></pre></div></div>

<p>This task outputs <code class="highlighter-rouge">main.js</code> to <code class="highlighter-rouge">_site/assets/js/main.js</code>. To avoid delaying the
initial render, we’re loading the scripts asynchronously via the <code class="highlighter-rouge">async</code>
attribute in our <code class="highlighter-rouge">scripts.html</code> template included on each page after the footer.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{# in scripts.html #}
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"https://savaslabs.com/assets/js/main.js"</span> <span class="na">async</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;noscript&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'/assets/styles/main.css'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
<span class="nt">&lt;/noscript&gt;</span>
</code></pre></div></div>

<p>As before, we also have a task to delete all processed scripts.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Deletes processed JS.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean:scripts'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">del</span><span class="p">([</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllJsFiles</span> <span class="o">+</span> <span class="s1">'main.js'</span><span class="p">,</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteJsFiles</span> <span class="o">+</span> <span class="s1">'main.js'</span><span class="p">]);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="copy-fonts">Copy fonts</h3>

<p>I’ll quickly note that we set up a task to copy our fonts to the appropriate
directory, but we’re only doing this with Font Awesome at the moment.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Copies fonts.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:fonts'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'fontawesome'</span><span class="p">]);</span>

<span class="c1">// Places Font Awesome fonts in proper location.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'fontawesome'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">fontFiles</span> <span class="o">+</span> <span class="s1">'/font-awesome/**.*'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">rename</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span><span class="nx">path</span><span class="p">.</span><span class="nx">dirname</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;}))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllFontFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">siteFontFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">browserSync</span><span class="p">.</span><span class="nx">stream</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Deletes processed fonts.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean:fonts'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">del</span><span class="p">([</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllFontFiles</span><span class="p">,</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteFontFiles</span><span class="p">]);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="process-images">Process images</h3>

<p>We took a few steps to optimize our site’s existing images and ensure that
future images could be optimized automatically via gulp and the Jekyll build
process.</p>

<h4 id="manual-updates-to-images">Manual updates to images</h4>

<p>We knocked out some low-hanging fruit by ensuring we were using the proper image
formats and the smallest images possible. Google has a <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/image-optimization">great writeup on image
optimization</a>
that I’d highly recommend reading, but the gist is:</p>

<ul>
  <li>Don’t use images if you can use CSS or webfonts</li>
  <li>Choose the right image format:
    <ul>
      <li>If it’s a vector graphic or can be converted to one, use SVG</li>
      <li>If you need transparency or fine detail, use PNG</li>
      <li>If you need animation, use GIF</li>
      <li>Otherwise, use JPEG</li>
    </ul>
  </li>
  <li>Play around with image quality to find the lowest quality that still looks great</li>
  <li>Your images shouldn’t be any larger than the largest they’ll display on your
site (keeping in mind this might be 2x for high resolution displays)</li>
</ul>

<p>On my Mac, I used <a href="https://www.sketchapp.com/">Sketch</a> to convert some of our
images from PNG to JPEG at a slightly lower quality, to save vector graphics as
SVGs when possible, and to trim images down when they were larger than they
needed to be. We also established these rules as a team for future images to be
added to our site.</p>

<h4 id="minify-images-via-gulp">Minify images via gulp</h4>

<p>Next, we wrote a gulp task to run our images through the <code class="highlighter-rouge">imagemin</code> plugin.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Optimizes and copies image files.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:images'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">imageFilesGlob</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">imagemin</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllImageFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">siteImageFiles</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">browserSync</span><span class="p">.</span><span class="nx">stream</span><span class="p">());</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This task outputs optimized images in <code class="highlighter-rouge">_site/assets/img</code>.</p>

<p>We also have a task to delete all processed images.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Deletes processed images.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean:images'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">del</span><span class="p">([</span><span class="nx">paths</span><span class="p">.</span><span class="nx">jekyllImageFiles</span><span class="p">,</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteImageFiles</span><span class="p">]);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<h4 id="jekyll-picture-tag-plugin">Jekyll Picture Tag plugin</h4>

<p>Between our manual updates and <code class="highlighter-rouge">imagemin</code>, we cut our image sizes down
drastically! Our next step was to set up the
<a href="https://github.com/robwierzbowski/jekyll-picture-tag">Jekyll Picture Tag plugin</a>.
This plugin supplies a Liquid tag to insert a <code class="highlighter-rouge">&lt;picture&gt;</code> element, which
allows the browser to choose the most appropriate image from an array of sizes.
Since our sites are viewed on so many different devices, we need to send these
devices images that make sense — loading a huge image meant for a large retina
screen on a tiny mobile phone is a waste of time and resources. The Liquid
tag provided by the plugin is much simpler than typing out all the <code class="highlighter-rouge">&lt;picture&gt;</code>
markup, and the plugin also generates the differently sized images based on some
simple config. Since the <code class="highlighter-rouge">&lt;picture&gt;</code> element has very low browser support at
this time, <a href="https://github.com/scottjehl/picturefill">Picturefill</a> is used as a
polyfill, meaning the resulting markup will work in all modern browsers.</p>

<p>But wait - how can we use a Jekyll plugin while we’re hosting our site on GitHub
Pages? GitHub Pages only allows
<a href="https://pages.github.com/versions/">a few Jekyll plugins</a> when it builds a site
for deployment, a well-known limitation. <a href="/2016/10/25/deploy-jekyll-with-travis.html">Read about how we’re using Travis CI
to build our site for testing and deployment to GitHub Pages so we can use
Jekyll plugins.</a></p>

<p>The <a href="https://github.com/robwierzbowski/jekyll-picture-tag#installation">installation and usage</a>
documentation on Jekyll Picture Tag’s GitHub repo is great, and setup is a quick
matter of installing the gem and the Picturefill script. From there, we set up
presets for repeated image styles on our site - team photos, featured
blog images, etc.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># in config.yml</span>
<span class="c1"># Picture element presets</span>
<span class="na">picture</span><span class="pi">:</span>
  <span class="na">source</span><span class="pi">:</span> <span class="s2">"</span><span class="s">assets/img"</span>
  <span class="na">output</span><span class="pi">:</span> <span class="s2">"</span><span class="s">assets/processed-img"</span>
  <span class="na">markup</span><span class="pi">:</span> <span class="s2">"</span><span class="s">picture"</span>
  <span class="na">presets</span><span class="pi">:</span>
    <span class="na">team_square</span><span class="pi">:</span>
      <span class="na">attr</span><span class="pi">:</span>
        <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image--team-square"</span>
        <span class="na">itemprop</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image"</span>
      <span class="na">ppi</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="nv">2</span><span class="pi">]</span>
      <span class="na">source_400</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">400px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">334"</span>
      <span class="na">source_default</span><span class="pi">:</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">254"</span>
    <span class="na">team_individual</span><span class="pi">:</span>
      <span class="na">attr</span><span class="pi">:</span>
        <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image--team-individual"</span>
        <span class="na">itemprop</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image"</span>
      <span class="na">ppi</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="nv">2</span><span class="pi">]</span>
      <span class="na">source_400</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">400px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">350"</span>
      <span class="na">source_default</span><span class="pi">:</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">288"</span>
    <span class="na">team_post_meta</span><span class="pi">:</span>
      <span class="na">attr</span><span class="pi">:</span>
        <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image--team-post-meta"</span>
        <span class="na">itemprop</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image"</span>
      <span class="na">ppi</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="nv">2</span><span class="pi">]</span>
      <span class="na">source_default</span><span class="pi">:</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">288"</span>
    <span class="na">case_study</span><span class="pi">:</span>
      <span class="na">attr</span><span class="pi">:</span>
        <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image--case-study"</span>
        <span class="na">itemprop</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image"</span>
      <span class="na">ppi</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="nv">2</span><span class="pi">]</span>
      <span class="na">source_860</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">860px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">560"</span>
      <span class="na">source_640</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">640px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">430"</span>
      <span class="na">source_400</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">400px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">560"</span>
      <span class="na">source_default</span><span class="pi">:</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">400"</span>
    <span class="na">post_featured_image</span><span class="pi">:</span>
      <span class="na">attr</span><span class="pi">:</span>
        <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image--post-featured-image"</span>
        <span class="na">itemprop</span><span class="pi">:</span> <span class="s2">"</span><span class="s">image"</span>
      <span class="na">ppi</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="nv">2</span><span class="pi">]</span>
      <span class="na">source_1120</span><span class="pi">:</span>
        <span class="na">media</span><span class="pi">:</span> <span class="s2">"</span><span class="s">(min-width:</span><span class="nv"> </span><span class="s">400px)"</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">737"</span>
      <span class="na">source_default</span><span class="pi">:</span>
        <span class="na">width</span><span class="pi">:</span> <span class="s2">"</span><span class="s">400"</span>
</code></pre></div></div>

<p>First we set the source directory to <code class="highlighter-rouge">assets/img</code>, which is where images are
sent by gulp after being optimized. Resized images will be output to
<code class="highlighter-rouge">assets/processed-img</code>. Keep in mind that since this is being done during the
<code class="highlighter-rouge">jekyll build</code> process, the processed image directory will be inside the <code class="highlighter-rouge">_site</code>
directory.</p>

<p>Each preset has the following configured:</p>

<ul>
  <li>A <a href="http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/">BEM</a>-style
class (other attributes can be added too).</li>
  <li>An array of resolutions. <code class="highlighter-rouge">[1, 2]</code> will generate images at 1 and 2 times the
specified dimensions, and the double-sized image will be served on devices with
a resolution of at least 2 dots per pixel (better known as Retina screens).</li>
  <li>Source specifications. Each source contains a media query and a width to be
used at that screen size (I didn’t include height so the images will be scaled
proportionally).</li>
</ul>

<p>From here we use a simple Liquid tag to create the markup. For our
individual team member pages we insert the team member’s photo with:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% picture team_individual {{ page.photo }} alt="{{ page.name }}" %}

</code></pre></div></div>

<p>We’re using the <code class="highlighter-rouge">team_individual</code> preset, so four versions of the image will be
created (two at each specified width, and two images at double those dimensions
for hi-res displays). The markup ends up like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;picture&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"/assets/processed-img/team/anne-tomasevich-700by710-eeafb6.jpg"</span> <span class="na">media=</span><span class="s">"(min-width: 400px) and (-webkit-min-device-pixel-ratio: 2), (min-width: 400px) and (min-resolution: 192dpi)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"/assets/processed-img/team/anne-tomasevich-350by355-eeafb6.jpg"</span> <span class="na">media=</span><span class="s">"(min-width: 400px)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"/assets/processed-img/team/anne-tomasevich-576by584-eeafb6.jpg"</span> <span class="na">media=</span><span class="s">"(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/assets/processed-img/team/anne-tomasevich-288by292-eeafb6.jpg"</span> <span class="na">class=</span><span class="s">"image--team-individual"</span> <span class="na">itemprop=</span><span class="s">"image"</span> <span class="na">alt=</span><span class="s">"Anne Tomasevich"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div></div>

<p>With some easy setup, we’re cutting down drastically on the sizes of images
served at smaller screen sizes and lower resolutions!</p>

<h4 id="background-images">Background images</h4>

<p>One place we couldn’t use this plugin is for images displayed via the CSS
<code class="highlighter-rouge">background-image</code> property, which we’re using for some hero images. For the
large image on the home page, I manually created a variety of images (known in
the responsive image world as <a href="https://developers.google.com/web/fundamentals/design-and-ui/media/images#art_direction">art direction</a>)
then used media queries to display the appropriate image as the background image.
You can check out the <a href="https://github.com/savaslabs/savaslabs.github.io/blob/e61687f846a2ee605a5141cb9fa8a16c2de28339/_assets/styles/scss/components/_home-cover-image.scss">SCSS on GitHub</a>.
Since this is a much more time-consuming process I haven’t implemented this for
all of our background images yet, but taking the time to create images that will
look exactly how we want them at all screen sizes will be well worth it!</p>

<h3 id="build-and-serve-tasks">Build and serve tasks</h3>

<p>To pull it all together, we have a default task to build the site (creating the
<code class="highlighter-rouge">_site</code> directory which holds the compiled HTML, CSS, JS, and images that comprise our site)
and a <code class="highlighter-rouge">serve</code> task to watch our files and rebuild the appropriate files or the
entire site when those files change.</p>

<p>The default task deletes the site by running the <code class="highlighter-rouge">clean</code> tasks then runs all the
<code class="highlighter-rouge">build</code> tasks, then the <code class="highlighter-rouge">jekyll build</code> command to build the site using our
processed assets.</p>

<p>A little gulp tip: tasks passed within square brackets are run concurrently (one
of the major advantages of using gulp over Grunt, which can only run one task at
a time), while items in a comma-separated list are run sequentially. We’ll need
this to run the build tasks in the correct order since we need to create our
<code class="highlighter-rouge">assets</code> directory before running <code class="highlighter-rouge">build:jekyll</code>, which will copy <code class="highlighter-rouge">assets</code> to
<code class="highlighter-rouge">_site/assets</code>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Runs jekyll build command.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:jekyll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">shellCommand</span> <span class="o">=</span> <span class="s1">'bundle exec jekyll build --config _config.yml'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">run</span><span class="p">(</span><span class="nx">shellCommand</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Deletes the entire _site directory.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean:jekyll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">del</span><span class="p">([</span><span class="s1">'_site'</span><span class="p">]);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// Main clean task.</span>
<span class="c1">// Deletes _site directory and processed assets.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'clean:jekyll'</span><span class="p">,</span>
    <span class="s1">'clean:fonts'</span><span class="p">,</span>
    <span class="s1">'clean:images'</span><span class="p">,</span>
    <span class="s1">'clean:scripts'</span><span class="p">,</span>
    <span class="s1">'clean:styles'</span><span class="p">]);</span>

<span class="c1">// Builds site anew.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">runSequence</span><span class="p">(</span><span class="s1">'clean'</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">'build:scripts'</span><span class="p">,</span> <span class="s1">'build:images'</span><span class="p">,</span> <span class="s1">'build:styles'</span><span class="p">,</span> <span class="s1">'build:fonts'</span><span class="p">],</span>
        <span class="s1">'build:jekyll'</span><span class="p">,</span>
        <span class="nx">callback</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Default Task: builds site.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build'</span><span class="p">]);</span>
</code></pre></div></div>

<p>Now, <code class="highlighter-rouge">gulp</code> will run the default task <code class="highlighter-rouge">build</code> and will build the <code class="highlighter-rouge">_site</code>
directory. This is what we want in production, but let’s go back to our three
separate Jekyll configuration files. We want to create gulp tasks using
<code class="highlighter-rouge">config.test.yml</code> for running our test script and <code class="highlighter-rouge">config.dev.yml</code> for local
development.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Runs jekyll build command using test config.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:jekyll:test'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">shellCommand</span> <span class="o">=</span> <span class="s1">'bundle exec jekyll build --config _config.yml,_config.test.yml'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">run</span><span class="p">(</span><span class="nx">shellCommand</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Runs jekyll build command using local config.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:jekyll:local'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">shellCommand</span> <span class="o">=</span> <span class="s1">'bundle exec jekyll build --config _config.yml,_config.test.yml,_config.dev.yml'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">run</span><span class="p">(</span><span class="nx">shellCommand</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span> <span class="nx">gutil</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>The last thing we needed is a gulp command to serve the site and watch for file
changes. To accomplish this we’re using <code class="highlighter-rouge">gulp.watch()</code>, which tells gulp to run
a specified task if the targeted files are changed. We also created a couple of
special tasks to tell the browser to reload the served site on changes to Jekyll
files (templates, config, etc.) or Javascript files. We already included
<code class="highlighter-rouge">.pipe(browserSync.stream())</code> in our <code class="highlighter-rouge">build:styles:main</code> and <code class="highlighter-rouge">build:images</code> tasks, so
when these files are updated the changes will be injected into our local site
and we won’t even need a refresh.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Special tasks for building and then reloading BrowserSync.</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:jekyll:watch'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:local'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">browserSync</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build:scripts:watch'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:scripts'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">browserSync</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// Static Server + watching files.</span>
<span class="c1">// Note: passing anything besides hard-coded literal paths with globs doesn't</span>
<span class="c1">// seem to work with gulp.watch().</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'serve'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:local'</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">browserSync</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="na">server</span><span class="p">:</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">siteDir</span><span class="p">,</span>
        <span class="na">ghostMode</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// Toggle to mirror clicks, reloads etc. (performance)</span>
        <span class="na">logFileChanges</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">logLevel</span><span class="p">:</span> <span class="s1">'debug'</span><span class="p">,</span>
        <span class="na">open</span><span class="p">:</span> <span class="kc">true</span>        <span class="c1">// Toggle to automatically open page when starting.</span>
    <span class="p">});</span>

    <span class="c1">// Watch site settings.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">([</span><span class="s1">'_config.yml'</span><span class="p">],</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch .scss files; changes are piped to browserSync.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_assets/styles/**/*.scss'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:styles'</span><span class="p">]);</span>

    <span class="c1">// Watch .js files.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_assets/js/**/*.js'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:scripts:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch image files; changes are piped to browserSync.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_assets/img/**/*'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:images'</span><span class="p">]);</span>

    <span class="c1">// Watch posts.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_posts/**/*.+(md|markdown|MD)'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch drafts if --drafts flag was passed.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">drafts</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_drafts/*.+(md|markdown|MD)'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="c1">// Watch html and markdown files.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">([</span><span class="s1">'**/*.+(html|md|markdown|MD)'</span><span class="p">,</span> <span class="s1">'!_site/**/*.*'</span><span class="p">],</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch RSS feed XML file.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'feed.xml'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch data files.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'_data/**.*+(yml|yaml|csv|json)'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>

    <span class="c1">// Watch favicon.png.</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">'favicon.png'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'build:jekyll:watch'</span><span class="p">]);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>With this, we can run <code class="highlighter-rouge">gulp serve</code> to fire up our site locally. The initial
build takes a bit longer than <code class="highlighter-rouge">jekyll serve</code> but the convenience of
automatically opening a browser window, automatic refreshing, and new CSS being
injected is fantastic!</p>

<h2 id="the-results">The Results</h2>

<p>After implementing these changes, our mobile PageSpeed score shot up to 92/100,
with our desktop score at 95/100!</p>

<p><img src="/assets/img/blog/pagespeed-insights-results.jpg" alt="95/100 Google PageSpeed Insights score!" class="blog-image-full-width" /></p>

<hr />

<p>To pat ourselves on the back a little more, I should mention that we were already
doing great in the user experience department.</p>

<hr />

<p><img src="/assets/img/blog/pagespeed-insights-user-experience.jpg" alt="Passing Google PageSpeed Insights user experience items." class="blog-image-full-width" /></p>

<hr />

<p>That’s grounds for a little celebration in my opinion!</p>

<p><img src="/assets/img/blog/liz-lemon-self-five.gif" class="blog-image" style="max-width: 300px;" alt="Tina Fey as Liz Lemon giving herself an awesome high five." /></p>

<p>In addition to improving performance on our existing site, we now have a
framework in place to ensure good performance in the future — using gulp to
build the site for production will automatically optimize our CSS, JS, and image
assets. Plus, our local development workflow is more streamlined both because
we took the time to think through our asset pipeline and because we can
capitalize on tools like Browsersync to enhance the development experience.</p>

<h2 id="next-steps">Next Steps</h2>

<p>There are a couple things I’d like to improve with this process:</p>

<ul>
  <li>Once an image is optimized via imagemin it shouldn’t be processed each time
<code class="highlighter-rouge">build:images</code> runs. By doing this, we’ll save time both when building the site
for testing and deployment and for spinning up the site locally.</li>
  <li>Similarly, once an image is processed by Jekyll Picture Tag it doesn’t need to
be re-processed on every run of <code class="highlighter-rouge">jekyll build</code>.</li>
</ul>

<h2 id="further-resources">Further Resources</h2>

<ul>
  <li><a href="https://aaronlasseigne.com/2016/02/03/using-gulp-with-jekyll/">Aaron Lasseigne’s take on gulp + Jekyll</a>,
which breaks down the gulp tasks nicely</li>
  <li><a href="https://www.smashingmagazine.com/2014/06/building-with-gulp/">Smashing Magazine’s deep dive into gulp</a>,
a must-read for gulp beginners!</li>
  <li><a href="https://www.smashingmagazine.com/2014/05/responsive-images-done-right-guide-picture-srcset/">Smashing Magazine’s guide to the <code class="highlighter-rouge">&lt;picture&gt;</code> element</a></li>
</ul>

    </article>
  </div>
  <div class="region--prev-next-links region--prev-next-links--mobile pagination">
    <div class="outer-container">
  
  <a href="/2016/09/23/supercharged-seo-with-drupal-8.html" class="pagination__previous"><i class="fa fa-angle-left "></i> Prev</a>
  
  <a href="/blog" class="pagination__view-all">View All Blog Posts</a>
  
  <a href="/2016/10/25/deploy-jekyll-with-travis.html" class="pagination__next"> Next <i class="fa fa-angle-right"></i></a>
  
</div>
  </div>
  <div class="page--post__aside region--post-aside">
    <div class="region--post-aside__section__wrapper--posts">
      <div class="region--post-aside__section region--post-aside__section--posts">
        <h2 class="heading--sans-serif c-grey h3">Related Blog Posts</h2>
        <div class="region--post-aside__section__items region--post-aside__section--posts__items">
          





























<div class="tile--blog tile--blog--detailed tile">
  <a href="/2019/12/06/six-months-in.html" class="tile--blog__link">
    <div class="tile--blog__content tile__content bg-light-teal">
      
      <div class="tile--blog__image" style="background-image: url(/assets/img/blog/madeline-six-mo-blog.jpg);">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p class="tile--blog--detailed__primary-tag">Front End Development</p>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </div>
      <div class="tile--blog__post-title">
        <p>Six months in: Revelations and Roadblocks as a Junior Developer</p>

        <div class="tile--blog--detailed__author">
          
          
          <picture>
    <source srcset="https://savaslabs.com/assets/processed-img/team/madeline-streilein/madeline-streilein-square-outside-120by120-68956d.jpg" media="(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/team/madeline-streilein/madeline-streilein-square-outside-60by60-68956d.jpg">
    <img src="https://savaslabs.com/assets/processed-img/team/madeline-streilein/madeline-streilein-square-outside-60by60-68956d.jpg" class="image--team-blog-tile" itemprop="image" alt="Madeline Streilein" >
  </picture>

          
          
        </div>
        <div class="tile--blog--detailed__author-bg"></div>
      </div>
    </div>
    <div class="tile--blog__hover tile__hover bg-orange">
      <p>Ever wondered what beginning a dev career at a web agency is like? One of our own shares hurdles, highlights, and tips as she reflects on half a year at Savas Labs.</p>

      <p class="link--cta link--cta--inverse">Read more</p>
    </div>
  </a>
</div>

































<div class="tile--blog tile--blog--detailed tile">
  <a href="/2019/11/06/using-tailwind-for-css.html" class="tile--blog__link">
    <div class="tile--blog__content tile__content bg-light-teal">
      
      <div class="tile--blog__image" style="background-image: url(/assets/img/blog/tailwindcss.jpg);">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p class="tile--blog--detailed__primary-tag">Storybook</p>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </div>
      <div class="tile--blog__post-title">
        <p>Using Tailwind for CSS</p>

        <div class="tile--blog--detailed__author">
          
          
          <picture>
    <source srcset="https://savaslabs.com/assets/processed-img/team/alex-manzo/alex-manzo-square-outside-120by120-d5d883.jpg" media="(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)">
    <source srcset="https://savaslabs.com/assets/processed-img/team/alex-manzo/alex-manzo-square-outside-60by60-d5d883.jpg">
    <img src="https://savaslabs.com/assets/processed-img/team/alex-manzo/alex-manzo-square-outside-60by60-d5d883.jpg" class="image--team-blog-tile" itemprop="image" alt="Alex Manzo" >
  </picture>

          
          
        </div>
        <div class="tile--blog--detailed__author-bg"></div>
      </div>
    </div>
    <div class="tile--blog__hover tile__hover bg-orange">
      <p>In the spirit of efficiency and team cohesion, Savas Labs has recently utilized Tailwind CSS, a utility-first CSS framework. This has proven especially useful in keeping styles organized, reusable, and functional across projects even with multiple developers and writing styles. This is how we did it.</p>

      <p class="link--cta link--cta--inverse">Read more</p>
    </div>
  </a>
</div>












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        </div>
      </div>
    </div>
    <div class="region--post-aside__section__wrapper--case-studies">
      <div class="region--post-aside__section region--post-aside__section--case-studies">
        <h2 class="heading--sans-serif c-grey h3">Related Case Studies</h2>
        <div class="region--post-aside__section__items region--post-aside__section--posts__items">
          













<div class="case-study-block">
  <a class="case-study-block__link" href="/results/case-studies/darden-main/">
    <div class="case-study-block__image" style="background-image: url(/assets/img/work/logos/uva-darden-main-logo-eggshell.png);">
      <img src="/assets/img/work/uva-darden-main/uva-darden-main-block.jpg" alt="University of Virginia Darden School of Business">
    </div>
    
    <h3 class="case-study-block__title">University of Virginia Darden School of Business</h3>
    
    <div class="case-study-block__tags">
      
      
      <p>Drupal </p>
      
      <p>&bull; </p>
      
      
      
      <p>Content Migration </p>
      
      <p>&bull; </p>
      
      
      
      <p>Tailwind </p>
      
      <p>&bull; </p>
      
      
      
      <p>CSS </p>
      
      
      
    </div>
  </a>
</div>
























<div class="case-study-block">
  <a class="case-study-block__link" href="/results/case-studies/videntity-smh/">
    <div class="case-study-block__image" style="background-image: url(/assets/img/work/logos/videntity-logo-eggshell.png);">
      <img src="/assets/img/work/videntity-smh/videntity-smh-block.jpg" alt="Videntity Share My Health Prototype">
    </div>
    
    <h3 class="case-study-block__title">Videntity Share My Health Prototype</h3>
    
    <div class="case-study-block__tags">
      
      
      <p>React </p>
      
      <p>&bull; </p>
      
      
      
      <p>Rapid Prototyping </p>
      
      <p>&bull; </p>
      
      
      
      <p>Bootstrap </p>
      
      <p>&bull; </p>
      
      
      
      <p>ES6+ </p>
      
      
      
    </div>
  </a>
</div>

































































































































































        </div>
        <div class="region--post-aside__section--case-studies__cta flex-center">
          <a href="/results" class="button--arrow--orange">Our work</a>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="region--prev-next-links region--prev-next-links--post pagination">
  <div class="outer-container">
  
  <a href="/2016/09/23/supercharged-seo-with-drupal-8.html" class="pagination__previous"><i class="fa fa-angle-left "></i> Prev</a>
  
  <a href="/blog" class="pagination__view-all">View All Blog Posts</a>
  
  <a href="/2016/10/25/deploy-jekyll-with-travis.html" class="pagination__next"> Next <i class="fa fa-angle-right"></i></a>
  
</div>
</div>

<div class="region--comments">
  
  <div id="js-comments"></div>
  
</div>

    </div>

    <footer class="region--footer" role="contentinfo">
  <div class="region--footer__main">
    <div class="region--footer__main__menu">
      <a href="/" class="region--footer__logo">
        <img src="https://savaslabs.com/assets/img/logo-light.svg" alt="Savas Labs" class="savas-logo savas-logo--light">
      </a>
      <nav role="navigation" class="footer-navigation">
  <ul class="footer-navigation__menu">
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/careers">We're hiring!</a>
      </li>
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/company">Company</a>
      </li>
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/results">Results</a>
      </li>
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/services">Services</a>
      </li>
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/blog">Blog</a>
      </li>
    
      
      
      
      <li class="footer-navigation__menu-link ">
        <a href="/contact">Contact</a>
      </li>
    
  </ul>
</nav>
    </div>
    <div class="region--footer__main__contact">
      <h3 class="region--footer__main__contact__title h5">Connect with us</h3>
      <a href="mailto:info@savaslabs.com">info@savaslabs.com</a>
      <p>(919) 432-4660</p>
      <address>
        Savas Labs<br>
        212 W Main Street, Suite 303<br>
        Durham, NC 27701
      </address>
    </div>
    <div class="region--footer__main__social">
      <div class="region--footer__main__social__icons">
        <ul>
          <li><a href="https://github.com/savaslabs"><i class="fa fa-github fa-lg fa-2x"></i><span class="sr-only">Savas Labs GitHub</span></a></li>
          <li><a href="https://www.drupal.org/savas-labs"><i class="fa fa-drupal fa-lg fa-2x"></i><span class="sr-only">Savas Labs Drupal.Org</span></a></li>
          <li><a href="https://twitter.com/SavasLabs"><i class="fa fa-twitter fa-lg fa-2x"></i><span class="sr-only">Savas Labs Twitter</span></a></li>
          <li><a href="https://www.linkedin.com/company/savas-labs"><i class="fa fa-linkedin fa-lg fa-2x"></i><span class="sr-only">Savas Labs LinkedIn</span></a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="region--footer__bottom">
    <div class="region--footer__bottom__wrapper">
      <p class="region--footer__bottom__copyright">
        Copyright &copy; Savas Labs 2019
      </p>
    </div>
  </div>
</footer>

    <script type="text/javascript" src="https://savaslabs.com/assets/js/main.js" async></script>


<script type="text/javascript" src="/assets/js/comments.js" async></script>

<noscript>
  <link href='/assets/styles/main.css' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic|PT+Serif|Source+Sans+Pro' rel='stylesheet' type='text/css'>
</noscript>

  </body>

</html>
